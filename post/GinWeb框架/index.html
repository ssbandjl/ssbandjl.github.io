<!doctype html>
<html lang="zh-CN">
<head>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7571343657358120"
     crossorigin="anonymous"></script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    

    <title>GinWeb框架 | 晓兵(ssbandjl)-技术兴国</title>
    <meta property="og:title" content="GinWeb框架 - 晓兵(ssbandjl)-技术兴国">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2022-04-16T13:14:40&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2022-04-16T13:14:40&#43;08:00'>
        
    <meta name="Keywords" content="c,c&#43;&#43;,golang,python,存储,ceph,分布式块存储,云计算,daos,rdma,spdk,nvmeof,linux,kernel,内核,分布式存储,dpdk,rpc">
    <meta name="description" content="GinWeb框架">
        
    <meta name="author" content="晓兵">
    <meta property="og:url" content="https://logread.cn/post/GinWeb%E6%A1%86%E6%9E%B6/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://logread.cn">
                        晓兵(ssbandjl)-技术兴国
                    </a>
                
                <p class="description">存储 | DPU | 高性能 | RDMA | DAOS | 内核等, AI吐槽工具: https://chattoyou.cn</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://logread.cn">首页</a>
                    
                    <a  href="https://logread.cn/archives/" title="归档">归档</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#简介">简介</a></li>
    <li><a href="#云原生">云原生</a></li>
    <li><a href="#内容">内容</a></li>
    <li><a href="#安装">安装</a></li>
    <li><a href="#快速开始">快速开始</a></li>
    <li><a href="#基准测试">基准测试</a></li>
    <li><a href="#ginv1稳定版">GinV1稳定版</a></li>
    <li><a href="#使用jsoniterhttpsgithubcomjson-iteratorgo编译">使用<a href="https://github.com/json-iterator/go">jsoniter</a>编译</a></li>
    <li><a href="#api示例">API示例</a>
      <ul>
        <li><a href="#使用getpostputpatchdeleteoptions">使用GET,POST,PUT,PATCH,DELETE,OPTIONS</a></li>
        <li><a href="#获取请求中的路径参数">获取请求中的路径参数</a></li>
        <li><a href="#获取查询字符串参数">获取查询字符串参数</a></li>
        <li><a href="#获取multiparturlencoded类型表单">获取Multipart/Urlencoded类型表单</a></li>
        <li><a href="#另一个示例查询参数和post表单">另一个示例,查询参数和Post表单</a></li>
        <li><a href="#以map映射作为查询字符串或post表单参数">以Map映射作为查询字符串或Post表单参数</a></li>
        <li><a href="#上传文件">上传文件</a></li>
        <li><a href="#路由分组">路由分组</a></li>
        <li><a href="#gin引擎初始化不带中间件或使用日志和异常恢复中间件">Gin引擎初始化(不带中间件或使用日志和异常恢复中间件)</a></li>
        <li><a href="#使用中间件">使用中间件</a></li>
        <li><a href="#自定义程序崩溃后的处理方式邮件微信短信等告警">自定义程序崩溃后的处理方式(邮件/微信/短信等告警)</a></li>
        <li><a href="#怎样记录日志到文件">怎样记录日志到文件</a></li>
        <li><a href="#自定义日志格式">自定义日志格式</a></li>
        <li><a href="#控制日志输出颜色">控制日志输出颜色</a></li>
        <li><a href="#模型绑定和验证">模型绑定和验证</a></li>
        <li><a href="#自定义验证器">自定义验证器</a></li>
        <li><a href="#只绑定查询字符串">只绑定查询字符串</a></li>
        <li><a href="#绑定查询字符串或post表单数据">绑定查询字符串或Post表单数据</a></li>
        <li><a href="#绑定uri">绑定URI</a></li>
        <li><a href="#绑定请求头">绑定请求头</a></li>
        <li><a href="#绑定html复选框">绑定HTML复选框</a></li>
        <li><a href="#绑定multiparturlencoded类型的表单">绑定Multipart/Urlencoded类型的表单</a></li>
        <li><a href="#xmljsonyamlprotobuf等渲染">XML,JSON,YAML,ProtoBuf等渲染</a></li>
        <li><a href="#静态文件服务">静态文件服务</a></li>
        <li><a href="#返回文件数据">返回文件数据</a></li>
        <li><a href="#用文件读出器提供文件数据服务">用文件读出器提供文件数据服务</a></li>
        <li><a href="#html渲染">HTML渲染</a></li>
        <li><a href="#多个模板">多个模板</a></li>
        <li><a href="#重定向">重定向</a></li>
        <li><a href="#自定义中间件">自定义中间件</a></li>
        <li><a href="#使用基本认证basicauth中间件">使用基本认证BasicAuth()中间件</a></li>
        <li><a href="#在中间件中使用协程goroutines">在中间件中使用协程Goroutines</a></li>
        <li><a href="#自定义http配置">自定义HTTP配置</a></li>
        <li><a href="#支持letsencrypt证书加密处理https">支持Let&rsquo;sEncrypt证书加密处理HTTPS</a></li>
        <li><a href="#使用gin运行多个服务">使用Gin运行多个服务</a></li>
        <li><a href="#优雅的关闭和重启服务">优雅的关闭和重启服务</a></li>
        <li><a href="#将模板文件一起编译为一个二进制单文件">将模板文件一起编译为一个二进制单文件</a></li>
        <li><a href="#使用自定义的结构绑定请求表单">使用自定义的结构绑定请求表单</a></li>
        <li><a href="#尝试将请求体绑定到不同的结构">尝试将请求体绑定到不同的结构</a></li>
        <li><a href="#http2服务推送">http2服务推送</a></li>
        <li><a href="#定义路由日志格式">定义路由日志格式</a></li>
        <li><a href="#设置和读取cookie">设置和读取Cookie</a></li>
      </ul>
    </li>
    <li><a href="#测试">测试</a></li>
    <li><a href="#gin框架用户">Gin框架用户</a></li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">GinWeb框架</h1>
        </header>
        <date class="post-meta meta-date">
            2022年4月16日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='/categories/%E6%A1%86%E6%9E%B6'>框架</a></span>
            
            <span class="meta-category"><a href='/categories/golang'>golang</a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <h1 id="author-晓兵">Author 晓兵</h1>
<h4 id="weixin-ssbandjl">weixin: ssbandjl</h4>
<h4 id="公众号-云原生云">公众号: 云原生云</h4>
<p>
        <img class="mx-auto" alt="云原生云" src="../../logo.gif" />   
    </p>
<h1 id="ginweb框架">GinWeb框架</h1>
<!-- raw HTML omitted -->
<p><a href="https://travis-ci.org/gin-gonic/gin">
        <img class="mx-auto" alt="Build Status" src="https://travis-ci.org/gin-gonic/gin.svg" />   
    </a>
<a href="https://codecov.io/gh/gin-gonic/gin">
        <img class="mx-auto" alt="codecov" src="https://codecov.io/gh/gin-gonic/gin/branch/master/graph/badge.svg" />   
    </a>
<a href="https://goreportcard.com/report/github.com/gin-gonic/gin">
        <img class="mx-auto" alt="Go Report Card" src="https://goreportcard.com/badge/github.com/gin-gonic/gin" />   
    </a>
<a href="https://pkg.go.dev/github.com/gin-gonic/gin?tab=doc">
        <img class="mx-auto" alt="GoDoc" src="https://pkg.go.dev/badge/github.com/gin-gonic/gin?status.svg" />   
    </a>
<a href="https://gitter.im/gin-gonic/gin?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge">
        <img class="mx-auto" alt="Join the chat at https://gitter.im/gin-gonic/gin" src="https://badges.gitter.im/Join%20Chat.svg" />   
    </a>
<a href="https://sourcegraph.com/github.com/gin-gonic/gin?badge">
        <img class="mx-auto" alt="Sourcegraph" src="https://sourcegraph.com/github.com/gin-gonic/gin/-/badge.svg" />   
    </a>
<a href="https://www.codetriage.com/gin-gonic/gin">
        <img class="mx-auto" alt="Open Source Helpers" src="https://www.codetriage.com/gin-gonic/gin/badges/users.svg" />   
    </a>
<a href="https://github.com/gin-gonic/gin/releases">
        <img class="mx-auto" alt="Release" src="https://img.shields.io/github/release/gin-gonic/gin.svg?style=flat-square" />   
    </a>
<a href="https://www.tickgit.com/browse?repo=github.com/gin-gonic/gin">
        <img class="mx-auto" alt="TODOs" src="https://badgen.net/https/api.tickgit.com/badgen/github.com/gin-gonic/gin" />   
    </a></p>
<h2 id="简介">简介</h2>
<p>本文基于Golang Gin框架<a href="https://github.com/gin-gonic/gin">官方文档</a>翻译, 验证了其中大部分示例代码, 便于Gin快速入门, 也欢迎大家提出意见, 一起交流学习.</p>
<p>本文地址: <a href="https://github.com/ssbandjl/golang-gin-doc-cn">https://github.com/ssbandjl/golang-gin-doc-cn</a></p>
<p>Gin是Golang写的Web框架, 功能类似另一个Go框架<a href="https://github.com/go-martini/martini">Martini</a>(暂停维护), Gin内部使用定制版本的<a href="https://github.com/julienschmidt/httprouter">httprouter</a>(一款轻量级高性能HTTP请求路由器,或叫多路复用器), 速度是Martini的40倍, Gin拥有强大的性能,高效率,以及可扩展性, 所以赶快用起来吧!</p>
<h2 id="云原生">云原生</h2>
<p>更多云原生相关技术干货, 欢迎大家关注我的微信公众号:<strong>云原生云</strong></p>
<p>
        <img class="mx-auto" alt="云原生云二维码" src="img/%e4%ba%91%e5%8e%9f%e7%94%9f%e4%ba%91%e4%ba%8c%e7%bb%b4%e7%a0%81%e5%a4%a7.gif" />   
    </p>
<h2 id="内容">内容</h2>
<ul>
<li><a href="#author-%E6%99%93%E5%85%B5">Author 晓兵</a>
- <a href="#weixin-ssbandjl">weixin: ssbandjl</a>
- <a href="#%E5%85%AC%E4%BC%97%E5%8F%B7-%E4%BA%91%E5%8E%9F%E7%94%9F%E4%BA%91">公众号: 云原生云</a></li>
<li><a href="#ginweb%E6%A1%86%E6%9E%B6">GinWeb框架</a>
<ul>
<li><a href="#%E7%AE%80%E4%BB%8B">简介</a></li>
<li><a href="#%E4%BA%91%E5%8E%9F%E7%94%9F">云原生</a></li>
<li><a href="#%E5%86%85%E5%AE%B9">内容</a></li>
<li><a href="#%E5%AE%89%E8%A3%85">安装</a></li>
<li><a href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B">快速开始</a></li>
<li><a href="#%E5%9F%BA%E5%87%86%E6%B5%8B%E8%AF%95">基准测试</a></li>
<li><a href="#ginv1%E7%A8%B3%E5%AE%9A%E7%89%88">GinV1稳定版</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8jsoniter%E7%BC%96%E8%AF%91">使用jsoniter编译</a></li>
<li><a href="#api%E7%A4%BA%E4%BE%8B">API示例</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8getpostputpatchdeleteoptions">使用GET,POST,PUT,PATCH,DELETE,OPTIONS</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E4%B8%AD%E7%9A%84%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0">获取请求中的路径参数</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E6%9F%A5%E8%AF%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8F%82%E6%95%B0">获取查询字符串参数</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96multiparturlencoded%E7%B1%BB%E5%9E%8B%E8%A1%A8%E5%8D%95">获取Multipart/Urlencoded类型表单</a></li>
<li><a href="#%E5%8F%A6%E4%B8%80%E4%B8%AA%E7%A4%BA%E4%BE%8B%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0%E5%92%8Cpost%E8%A1%A8%E5%8D%95">另一个示例,查询参数和Post表单</a></li>
<li><a href="#%E4%BB%A5map%E6%98%A0%E5%B0%84%E4%BD%9C%E4%B8%BA%E6%9F%A5%E8%AF%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%96post%E8%A1%A8%E5%8D%95%E5%8F%82%E6%95%B0">以Map映射作为查询字符串或Post表单参数</a></li>
<li><a href="#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6">上传文件</a>
<ul>
<li><a href="#%E5%8D%95%E4%B8%AA%E6%96%87%E4%BB%B6">单个文件</a></li>
<li><a href="#%E5%A4%9A%E4%B8%AA%E6%96%87%E4%BB%B6">多个文件</a></li>
</ul>
</li>
<li><a href="#%E8%B7%AF%E7%94%B1%E5%88%86%E7%BB%84">路由分组</a></li>
<li><a href="#gin%E5%BC%95%E6%93%8E%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8D%E5%B8%A6%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%88%96%E4%BD%BF%E7%94%A8%E6%97%A5%E5%BF%97%E5%92%8C%E5%BC%82%E5%B8%B8%E6%81%A2%E5%A4%8D%E4%B8%AD%E9%97%B4%E4%BB%B6">Gin引擎初始化(不带中间件或使用日志和异常恢复中间件)</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E4%B8%AD%E9%97%B4%E4%BB%B6">使用中间件</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%A8%8B%E5%BA%8F%E5%B4%A9%E6%BA%83%E5%90%8E%E7%9A%84%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E9%82%AE%E4%BB%B6%E5%BE%AE%E4%BF%A1%E7%9F%AD%E4%BF%A1%E7%AD%89%E5%91%8A%E8%AD%A6">自定义程序崩溃后的处理方式(邮件/微信/短信等告警)</a></li>
<li><a href="#%E6%80%8E%E6%A0%B7%E8%AE%B0%E5%BD%95%E6%97%A5%E5%BF%97%E5%88%B0%E6%96%87%E4%BB%B6">怎样记录日志到文件</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F">自定义日志格式</a></li>
<li><a href="#%E6%8E%A7%E5%88%B6%E6%97%A5%E5%BF%97%E8%BE%93%E5%87%BA%E9%A2%9C%E8%89%B2">控制日志输出颜色</a></li>
<li><a href="#%E6%A8%A1%E5%9E%8B%E7%BB%91%E5%AE%9A%E5%92%8C%E9%AA%8C%E8%AF%81">模型绑定和验证</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%AA%8C%E8%AF%81%E5%99%A8">自定义验证器</a></li>
<li><a href="#%E5%8F%AA%E7%BB%91%E5%AE%9A%E6%9F%A5%E8%AF%A2%E5%AD%97%E7%AC%A6%E4%B8%B2">只绑定查询字符串</a></li>
<li><a href="#%E7%BB%91%E5%AE%9A%E6%9F%A5%E8%AF%A2%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%96post%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE">绑定查询字符串或Post表单数据</a></li>
<li><a href="#%E7%BB%91%E5%AE%9Auri">绑定URI</a></li>
<li><a href="#%E7%BB%91%E5%AE%9A%E8%AF%B7%E6%B1%82%E5%A4%B4">绑定请求头</a></li>
<li><a href="#%E7%BB%91%E5%AE%9Ahtml%E5%A4%8D%E9%80%89%E6%A1%86">绑定HTML复选框</a></li>
<li><a href="#%E7%BB%91%E5%AE%9Amultiparturlencoded%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%A1%A8%E5%8D%95">绑定Multipart/Urlencoded类型的表单</a></li>
<li><a href="#xmljsonyamlprotobuf%E7%AD%89%E6%B8%B2%E6%9F%93">XML,JSON,YAML,ProtoBuf等渲染</a>
<ul>
<li><a href="#%E5%AE%89%E5%85%A8%E7%9A%84json">安全的JSON</a></li>
<li><a href="#jsonp">JSONP</a></li>
<li><a href="#asciijson">AsciiJSON</a></li>
<li><a href="#%E4%B8%8D%E5%B8%A6%E8%BD%AC%E4%B9%89%E7%9A%84%E5%8E%9F%E5%A7%8Bjson">不带转义的原始JSON</a></li>
</ul>
</li>
<li><a href="#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1">静态文件服务</a></li>
<li><a href="#%E8%BF%94%E5%9B%9E%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE">返回文件数据</a></li>
<li><a href="#%E7%94%A8%E6%96%87%E4%BB%B6%E8%AF%BB%E5%87%BA%E5%99%A8%E6%8F%90%E4%BE%9B%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE%E6%9C%8D%E5%8A%A1">用文件读出器提供文件数据服务</a></li>
<li><a href="#html%E6%B8%B2%E6%9F%93">HTML渲染</a>
<ul>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93%E5%99%A8">自定义模板渲染器</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%88%86%E9%9A%94%E7%AC%A6">自定义分隔符</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95">自定义模板方法</a></li>
</ul>
</li>
<li><a href="#%E5%A4%9A%E4%B8%AA%E6%A8%A1%E6%9D%BF">多个模板</a></li>
<li><a href="#%E9%87%8D%E5%AE%9A%E5%90%91">重定向</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6">自定义中间件</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E5%9F%BA%E6%9C%AC%E8%AE%A4%E8%AF%81basicauth%E4%B8%AD%E9%97%B4%E4%BB%B6">使用基本认证BasicAuth()中间件</a></li>
<li><a href="#%E5%9C%A8%E4%B8%AD%E9%97%B4%E4%BB%B6%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8D%8F%E7%A8%8Bgoroutines">在中间件中使用协程Goroutines</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89http%E9%85%8D%E7%BD%AE">自定义HTTP配置</a></li>
<li><a href="#%E6%94%AF%E6%8C%81letsencrypt%E8%AF%81%E4%B9%A6%E5%8A%A0%E5%AF%86%E5%A4%84%E7%90%86https">支持Let&rsquo;sEncrypt证书加密处理HTTPS</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8gin%E8%BF%90%E8%A1%8C%E5%A4%9A%E4%B8%AA%E6%9C%8D%E5%8A%A1">使用Gin运行多个服务</a></li>
<li><a href="#%E4%BC%98%E9%9B%85%E7%9A%84%E5%85%B3%E9%97%AD%E5%92%8C%E9%87%8D%E5%90%AF%E6%9C%8D%E5%8A%A1">优雅的关闭和重启服务</a>
<ul>
<li><a href="#%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8C%85">使用第三方包</a></li>
<li><a href="#%E6%89%8B%E5%8A%A8%E5%AE%9E%E7%8E%B0">手动实现</a></li>
</ul>
</li>
<li><a href="#%E5%B0%86%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%E4%B8%80%E8%B5%B7%E7%BC%96%E8%AF%91%E4%B8%BA%E4%B8%80%E4%B8%AA%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8D%95%E6%96%87%E4%BB%B6">将模板文件一起编译为一个二进制单文件</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E7%BB%93%E6%9E%84%E7%BB%91%E5%AE%9A%E8%AF%B7%E6%B1%82%E8%A1%A8%E5%8D%95">使用自定义的结构绑定请求表单</a></li>
<li><a href="#%E5%B0%9D%E8%AF%95%E5%B0%86%E8%AF%B7%E6%B1%82%E4%BD%93%E7%BB%91%E5%AE%9A%E5%88%B0%E4%B8%8D%E5%90%8C%E7%9A%84%E7%BB%93%E6%9E%84">尝试将请求体绑定到不同的结构</a></li>
<li><a href="#http2%E6%9C%8D%E5%8A%A1%E6%8E%A8%E9%80%81">http2服务推送</a></li>
<li><a href="#%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F">定义路由日志格式</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E5%92%8C%E8%AF%BB%E5%8F%96cookie">设置和读取Cookie</a></li>
</ul>
</li>
<li><a href="#%E6%B5%8B%E8%AF%95">测试</a></li>
<li><a href="#gin%E6%A1%86%E6%9E%B6%E7%94%A8%E6%88%B7">Gin框架用户</a></li>
</ul>
</li>
</ul>
<h2 id="安装">安装</h2>
<p>为了安装Gin包, 你需要先安装Go, 并且设置Go工作空间.</p>
<ol>
<li>首先参考<a href="https://golang.org/">Go官方文档</a>安装Go(版本要求:<strong>Go1.12</strong>及以上), 然后执行以下命令安装Gin.</li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ go get -u github.com/gin-gonic/gin
</code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>导入gin包:</li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">import</span> <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>(可选)导入net/http包, 如果你要使用其中的常量,比如http.StatusOK,则需要导入</li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">import</span> <span style="color:#d14">&#34;net/http&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="快速开始">快速开始</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">编写main.go,写入以下代码并执行go run main.go, 访问http://localhost:8080/ping, 就可以得到响应消息<span style="color:#000;font-weight:bold">{</span><span style="color:#d14">&#34;message&#34;</span>: <span style="color:#d14">&#34;pong&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()  <span style="color:#998;font-style:italic">//创建默认Gin引擎Engine,内部默认开启了日志和异常恢复中间件
</span><span style="color:#998;font-style:italic"></span>  r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{
      <span style="color:#d14">&#34;message&#34;</span>: <span style="color:#d14">&#34;pong&#34;</span>,
    })
  })
  r.<span style="color:#900;font-weight:bold">Run</span>() <span style="color:#998;font-style:italic">//默认在localhost:8080监听
</span><span style="color:#998;font-style:italic"></span>}
</code></pre></td></tr></table>
</div>
</div><h2 id="基准测试">基准测试</h2>
<p>Gin 使用定制版本的<a href="https://github.com/julienschmidt/httprouter">HttpRouter</a></p>
<p><a href="/BENCHMARKS.md">查看所有基准测试</a></p>
<table>
<thead>
<tr>
<th>Benchmark name</th>
<th style="text-align:right">(1)</th>
<th style="text-align:right">(2)</th>
<th style="text-align:right">(3)</th>
<th style="text-align:right">(4)</th>
</tr>
</thead>
<tbody>
<tr>
<td>BenchmarkGin_GithubAll</td>
<td style="text-align:right"><strong>43550</strong></td>
<td style="text-align:right"><strong>27364 ns/op</strong></td>
<td style="text-align:right"><strong>0 B/op</strong></td>
<td style="text-align:right"><strong>0 allocs/op</strong></td>
</tr>
<tr>
<td>BenchmarkAce_GithubAll</td>
<td style="text-align:right">40543</td>
<td style="text-align:right">29670 ns/op</td>
<td style="text-align:right">0 B/op</td>
<td style="text-align:right">0 allocs/op</td>
</tr>
<tr>
<td>BenchmarkAero_GithubAll</td>
<td style="text-align:right">57632</td>
<td style="text-align:right">20648 ns/op</td>
<td style="text-align:right">0 B/op</td>
<td style="text-align:right">0 allocs/op</td>
</tr>
<tr>
<td>BenchmarkBear_GithubAll</td>
<td style="text-align:right">9234</td>
<td style="text-align:right">216179 ns/op</td>
<td style="text-align:right">86448 B/op</td>
<td style="text-align:right">943 allocs/op</td>
</tr>
<tr>
<td>BenchmarkBeego_GithubAll</td>
<td style="text-align:right">7407</td>
<td style="text-align:right">243496 ns/op</td>
<td style="text-align:right">71456 B/op</td>
<td style="text-align:right">609 allocs/op</td>
</tr>
<tr>
<td>BenchmarkBone_GithubAll</td>
<td style="text-align:right">420</td>
<td style="text-align:right">2922835 ns/op</td>
<td style="text-align:right">720160 B/op</td>
<td style="text-align:right">8620 allocs/op</td>
</tr>
<tr>
<td>BenchmarkChi_GithubAll</td>
<td style="text-align:right">7620</td>
<td style="text-align:right">238331 ns/op</td>
<td style="text-align:right">87696 B/op</td>
<td style="text-align:right">609 allocs/op</td>
</tr>
<tr>
<td>BenchmarkDenco_GithubAll</td>
<td style="text-align:right">18355</td>
<td style="text-align:right">64494 ns/op</td>
<td style="text-align:right">20224 B/op</td>
<td style="text-align:right">167 allocs/op</td>
</tr>
<tr>
<td>BenchmarkEcho_GithubAll</td>
<td style="text-align:right">31251</td>
<td style="text-align:right">38479 ns/op</td>
<td style="text-align:right">0 B/op</td>
<td style="text-align:right">0 allocs/op</td>
</tr>
<tr>
<td>BenchmarkGocraftWeb_GithubAll</td>
<td style="text-align:right">4117</td>
<td style="text-align:right">300062 ns/op</td>
<td style="text-align:right">131656 B/op</td>
<td style="text-align:right">1686 allocs/op</td>
</tr>
<tr>
<td>BenchmarkGoji_GithubAll</td>
<td style="text-align:right">3274</td>
<td style="text-align:right">416158 ns/op</td>
<td style="text-align:right">56112 B/op</td>
<td style="text-align:right">334 allocs/op</td>
</tr>
<tr>
<td>BenchmarkGojiv2_GithubAll</td>
<td style="text-align:right">1402</td>
<td style="text-align:right">870518 ns/op</td>
<td style="text-align:right">352720 B/op</td>
<td style="text-align:right">4321 allocs/op</td>
</tr>
<tr>
<td>BenchmarkGoJsonRest_GithubAll</td>
<td style="text-align:right">2976</td>
<td style="text-align:right">401507 ns/op</td>
<td style="text-align:right">134371 B/op</td>
<td style="text-align:right">2737 allocs/op</td>
</tr>
<tr>
<td>BenchmarkGoRestful_GithubAll</td>
<td style="text-align:right">410</td>
<td style="text-align:right">2913158 ns/op</td>
<td style="text-align:right">910144 B/op</td>
<td style="text-align:right">2938 allocs/op</td>
</tr>
<tr>
<td>BenchmarkGorillaMux_GithubAll</td>
<td style="text-align:right">346</td>
<td style="text-align:right">3384987 ns/op</td>
<td style="text-align:right">251650 B/op</td>
<td style="text-align:right">1994 allocs/op</td>
</tr>
<tr>
<td>BenchmarkGowwwRouter_GithubAll</td>
<td style="text-align:right">10000</td>
<td style="text-align:right">143025 ns/op</td>
<td style="text-align:right">72144 B/op</td>
<td style="text-align:right">501 allocs/op</td>
</tr>
<tr>
<td>BenchmarkHttpRouter_GithubAll</td>
<td style="text-align:right">55938</td>
<td style="text-align:right">21360 ns/op</td>
<td style="text-align:right">0 B/op</td>
<td style="text-align:right">0 allocs/op</td>
</tr>
<tr>
<td>BenchmarkHttpTreeMux_GithubAll</td>
<td style="text-align:right">10000</td>
<td style="text-align:right">153944 ns/op</td>
<td style="text-align:right">65856 B/op</td>
<td style="text-align:right">671 allocs/op</td>
</tr>
<tr>
<td>BenchmarkKocha_GithubAll</td>
<td style="text-align:right">10000</td>
<td style="text-align:right">106315 ns/op</td>
<td style="text-align:right">23304 B/op</td>
<td style="text-align:right">843 allocs/op</td>
</tr>
<tr>
<td>BenchmarkLARS_GithubAll</td>
<td style="text-align:right">47779</td>
<td style="text-align:right">25084 ns/op</td>
<td style="text-align:right">0 B/op</td>
<td style="text-align:right">0 allocs/op</td>
</tr>
<tr>
<td>BenchmarkMacaron_GithubAll</td>
<td style="text-align:right">3266</td>
<td style="text-align:right">371907 ns/op</td>
<td style="text-align:right">149409 B/op</td>
<td style="text-align:right">1624 allocs/op</td>
</tr>
<tr>
<td>BenchmarkMartini_GithubAll</td>
<td style="text-align:right">331</td>
<td style="text-align:right">3444706 ns/op</td>
<td style="text-align:right">226551 B/op</td>
<td style="text-align:right">2325 allocs/op</td>
</tr>
<tr>
<td>BenchmarkPat_GithubAll</td>
<td style="text-align:right">273</td>
<td style="text-align:right">4381818 ns/op</td>
<td style="text-align:right">1483152 B/op</td>
<td style="text-align:right">26963 allocs/op</td>
</tr>
<tr>
<td>BenchmarkPossum_GithubAll</td>
<td style="text-align:right">10000</td>
<td style="text-align:right">164367 ns/op</td>
<td style="text-align:right">84448 B/op</td>
<td style="text-align:right">609 allocs/op</td>
</tr>
<tr>
<td>BenchmarkR2router_GithubAll</td>
<td style="text-align:right">10000</td>
<td style="text-align:right">160220 ns/op</td>
<td style="text-align:right">77328 B/op</td>
<td style="text-align:right">979 allocs/op</td>
</tr>
<tr>
<td>BenchmarkRivet_GithubAll</td>
<td style="text-align:right">14625</td>
<td style="text-align:right">82453 ns/op</td>
<td style="text-align:right">16272 B/op</td>
<td style="text-align:right">167 allocs/op</td>
</tr>
<tr>
<td>BenchmarkTango_GithubAll</td>
<td style="text-align:right">6255</td>
<td style="text-align:right">279611 ns/op</td>
<td style="text-align:right">63826 B/op</td>
<td style="text-align:right">1618 allocs/op</td>
</tr>
<tr>
<td>BenchmarkTigerTonic_GithubAll</td>
<td style="text-align:right">2008</td>
<td style="text-align:right">687874 ns/op</td>
<td style="text-align:right">193856 B/op</td>
<td style="text-align:right">4474 allocs/op</td>
</tr>
<tr>
<td>BenchmarkTraffic_GithubAll</td>
<td style="text-align:right">355</td>
<td style="text-align:right">3478508 ns/op</td>
<td style="text-align:right">820744 B/op</td>
<td style="text-align:right">14114 allocs/op</td>
</tr>
<tr>
<td>BenchmarkVulcan_GithubAll</td>
<td style="text-align:right">6885</td>
<td style="text-align:right">193333 ns/op</td>
<td style="text-align:right">19894 B/op</td>
<td style="text-align:right">609 allocs/op</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>测试结果说明:</p>
<p>Benchmark name: 基准测试项</p>
<p>第(1)列:在固定时间内完成的重复次数, 值越大性能好</p>
<p>第(2)列:执行单次重复任务消耗的纳秒数, 单位ns/op, 值越低越好</p>
<p>第(3)列:执行单次重复任务消耗的堆内存字节数, 单位B/op, 值越低越好</p>
<p>第(4)列:每个重复任务平均分配内存的次数, 单位allocs/op, 值越低越好</p>
</li>
</ul>
<h2 id="ginv1稳定版">GinV1稳定版</h2>
<ul>
<li><input checked="" disabled="" type="checkbox"> 零内存分配的路由器</li>
<li><input checked="" disabled="" type="checkbox"> 仍然是最快的http路由器和框架</li>
<li><input checked="" disabled="" type="checkbox"> 完整的单元测试</li>
<li><input checked="" disabled="" type="checkbox"> 严格测试</li>
<li><input checked="" disabled="" type="checkbox"> API版本冻结,新发布的版本对你原来的代码兼容</li>
</ul>
<h2 id="使用jsoniterhttpsgithubcomjson-iteratorgo编译">使用<a href="https://github.com/json-iterator/go">jsoniter</a>编译</h2>
<p><a href="https://github.com/json-iterator/go">jsoniter</a>是一个高性能可以替代Golang标准库encoding/json并且完全兼容的包, Gin默认使用<code>encoding/json</code>包,但是你可以使用以下tags修改为jsoniter重新编译源码</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ go build -tags<span style="color:#000;font-weight:bold">=</span>jsoniter .
</code></pre></td></tr></table>
</div>
</div><h2 id="api示例">API示例</h2>
<p>你可以访问源码, 查看更多接口示例代码 <a href="https://github.com/gin-gonic/examples">Gin示例仓库</a>.</p>
<h3 id="使用getpostputpatchdeleteoptions">使用GET,POST,PUT,PATCH,DELETE,OPTIONS</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	<span style="color:#998;font-style:italic">// Creates a gin router with default middleware:
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// logger and recovery (crash-free) middleware
</span><span style="color:#998;font-style:italic"></span>	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someGet&#34;</span>, getting)
	router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/somePost&#34;</span>, posting)
	router.<span style="color:#900;font-weight:bold">PUT</span>(<span style="color:#d14">&#34;/somePut&#34;</span>, putting)
	router.<span style="color:#900;font-weight:bold">DELETE</span>(<span style="color:#d14">&#34;/someDelete&#34;</span>, deleting)
	router.<span style="color:#900;font-weight:bold">PATCH</span>(<span style="color:#d14">&#34;/somePatch&#34;</span>, patching)
	router.<span style="color:#900;font-weight:bold">HEAD</span>(<span style="color:#d14">&#34;/someHead&#34;</span>, head)
	router.<span style="color:#900;font-weight:bold">OPTIONS</span>(<span style="color:#d14">&#34;/someOptions&#34;</span>, options)

	<span style="color:#998;font-style:italic">// By default it serves on :8080 unless a
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// PORT environment variable was defined.
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">Run</span>()
	<span style="color:#998;font-style:italic">// router.Run(&#34;:3000&#34;) for a hard coded port
</span><span style="color:#998;font-style:italic"></span>}
</code></pre></td></tr></table>
</div>
</div><h3 id="获取请求中的路径参数">获取请求中的路径参数</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// This handler will match /user/john but will not match /user/ or /user
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//以下路由只会匹配/user/用户名, 不会匹配/user/或者/user
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/user/:name&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    name <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">Param</span>(<span style="color:#d14">&#34;name&#34;</span>) <span style="color:#998;font-style:italic">//使用Param方法从路径中获取参数
</span><span style="color:#998;font-style:italic"></span>    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">&#34;Hello %s&#34;</span>, name)
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// However, this one will match /user/john/ and also /user/john/send
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// If no other routers match /user/john, it will redirect to /user/john/
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 以下带冒号:和带星号*组成的路由可以匹配/user/用户名/或/user/用户名/动作,如果/user/用户名没有匹配到其他路由,它会自动重定向到/user/用户名/进行匹配
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/user/:name/*action&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    name <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">Param</span>(<span style="color:#d14">&#34;name&#34;</span>)
    action <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">Param</span>(<span style="color:#d14">&#34;action&#34;</span>)
    message <span style="color:#000;font-weight:bold">:=</span> name <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34; is &#34;</span> <span style="color:#000;font-weight:bold">+</span> action
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, message)
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// For each matched request Context will hold the route definition
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 请求上下文request Context会保存所有匹配上的路由定义到c.FullPath()方法
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/user/:name/*action&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    c.<span style="color:#900;font-weight:bold">FullPath</span>() <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#34;/user/:name/*action&#34;</span> <span style="color:#998;font-style:italic">// true
</span><span style="color:#998;font-style:italic"></span>  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="获取查询字符串参数">获取查询字符串参数</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Query string parameters are parsed using the existing underlying request object.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// The request responds to a url matching:  /welcome?firstname=Jane&amp;lastname=Doe
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 发送测试请求:/welcome?firstname=Jane&amp;lastname=Doe
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/welcome&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    firstname <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">DefaultQuery</span>(<span style="color:#d14">&#34;firstname&#34;</span>, <span style="color:#d14">&#34;Guest&#34;</span>) <span style="color:#998;font-style:italic">//如果没有获取到该键值,则使用第二个参数作为默认值
</span><span style="color:#998;font-style:italic"></span>    lastname <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">Query</span>(<span style="color:#d14">&#34;lastname&#34;</span>) 
    <span style="color:#998;font-style:italic">//上一行的完整写法:c.Request.URL.Query().Get(&#34;lastname&#34;)
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">&#34;Hello %s %s&#34;</span>, firstname, lastname)
  })
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="获取multiparturlencoded类型表单">获取Multipart/Urlencoded类型表单</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// 模拟提交表单:curl -XPOST http://localhost:8080/form_post -d &#34;message=消息&amp;nick=昵称&#34;
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/form_post&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    message <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">PostForm</span>(<span style="color:#d14">&#34;message&#34;</span>)
    nick <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">DefaultPostForm</span>(<span style="color:#d14">&#34;nick&#34;</span>, <span style="color:#d14">&#34;anonymous&#34;</span>)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{
      <span style="color:#d14">&#34;status&#34;</span>:  <span style="color:#d14">&#34;posted&#34;</span>,
      <span style="color:#d14">&#34;message&#34;</span>: message,
      <span style="color:#d14">&#34;nick&#34;</span>:    nick,
    })
  })
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">//返回结果: {&#34;message&#34;:&#34;消息&#34;,&#34;nick&#34;:&#34;昵称&#34;,&#34;status&#34;:&#34;posted&#34;}
</span></code></pre></td></tr></table>
</div>
</div><h3 id="另一个示例查询参数和post表单">另一个示例,查询参数和Post表单</h3>
<pre><code>POST /post?id=1234&amp;page=1 HTTP/1.1
Content-Type: application/x-www-form-urlencoded

name=manu&amp;message=this_is_great
</code></pre><div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;fmt&#34;</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/post&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    id <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">Query</span>(<span style="color:#d14">&#34;id&#34;</span>)
    page <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">DefaultQuery</span>(<span style="color:#d14">&#34;page&#34;</span>, <span style="color:#d14">&#34;0&#34;</span>)
    name <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">PostForm</span>(<span style="color:#d14">&#34;name&#34;</span>)
    message <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">PostForm</span>(<span style="color:#d14">&#34;message&#34;</span>)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    fmt.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;id: %s; page: %s; name: %s; message: %s\n&#34;</span>, id, page, name, message)
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{
      <span style="color:#d14">&#34;id&#34;</span>: id,
      <span style="color:#d14">&#34;page&#34;</span>: page,
      <span style="color:#d14">&#34;name&#34;</span>: name,
      <span style="color:#d14">&#34;message&#34;</span>: message,
    })
  })
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><pre><code>id: 1234; page: 1; name: manu; message: this_is_great
</code></pre><h3 id="以map映射作为查询字符串或post表单参数">以Map映射作为查询字符串或Post表单参数</h3>
<pre><code>POST /post?ids[a]=1234&amp;ids[b]=hello HTTP/1.1
Content-Type: application/x-www-form-urlencoded

names[first]=thinkerou&amp;names[second]=tianou
</code></pre><div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/post&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    ids <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">QueryMap</span>(<span style="color:#d14">&#34;ids&#34;</span>)  <span style="color:#998;font-style:italic">//获取查询参数中的Map
</span><span style="color:#998;font-style:italic"></span>    names <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">PostFormMap</span>(<span style="color:#d14">&#34;names&#34;</span>)   <span style="color:#998;font-style:italic">//获取Post表单中的Map
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
    fmt.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;ids: %v; names: %v\n&#34;</span>, ids, names)
  })
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><pre><code>模拟请求:
curl -XPOST http://localhost:8080/post?ids[a]=1234&amp;ids[b]=hello -d &quot;names[first]=thinkerou&amp;names[second]=tianou&quot;
打印结果:
ids: map[a:1234 b:hello]; names: map[first:thinkerou second:tianou]
</code></pre><h3 id="上传文件">上传文件</h3>
<h4 id="单个文件">单个文件</h4>
<p>参考问题 <a href="https://github.com/gin-gonic/gin/issues/774">#774</a>,  <a href="https://github.com/gin-gonic/examples/tree/master/upload-file/single">示例代码</a>.</p>
<p>文件名<code>file.Filename</code> 中带路径是不可信赖的, 参考 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition#Directives"><code>Content-Disposition</code> on MDN</a> 和问题 <a href="https://github.com/gin-gonic/gin/issues/1693">#1693</a></p>
<blockquote>
<p>文件名必须是安全可信赖的, 需要去掉路径信息,保留文件名即可</p>
</blockquote>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;fmt&#34;</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;log&#34;</span>
  <span style="color:#d14">&#34;net/http&#34;</span>
  <span style="color:#d14">&#34;os&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  <span style="color:#998;font-style:italic">// Set a lower memory limit for multipart forms (default is 32 MiB)
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 设置请求表单最大内存限制,默认是30MB
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">//内部调用http请求的ParseMultipartForm方法,该方法要求传入一个字节数, 要取MultipartForm字段的数据，先使用ParseMultipartForm()方法解析Form，解析时会读取所有数据，但需要指定保存在内存中的最大字节数，剩余的字节数会保存在临时磁盘文件中
</span><span style="color:#998;font-style:italic"></span>  maxMultipartMemory <span style="color:#000;font-weight:bold">:=</span> <span style="color:#0086b3">int64</span>(<span style="color:#099">8</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">20</span>)
  log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;解析文件到内存的最大字节:%d&#34;</span>, maxMultipartMemory)
  router.MaxMultipartMemory = maxMultipartMemory  <span style="color:#998;font-style:italic">// 8 MiB
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/upload&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#998;font-style:italic">// single file
</span><span style="color:#998;font-style:italic"></span>    file, _ <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">FormFile</span>(<span style="color:#d14">&#34;file&#34;</span>)  <span style="color:#998;font-style:italic">//FormFile从表单中返回第一个匹配到的文件对象(结构)
</span><span style="color:#998;font-style:italic"></span>    log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;获取到的文件名:%s&#34;</span>, file.Filename)  <span style="color:#998;font-style:italic">//文件名必须是安全可信耐的,需要去掉路径信息,保留文件名即可
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
    <span style="color:#998;font-style:italic">// Upload the file to specific dst.
</span><span style="color:#998;font-style:italic"></span>    currentPath, _ <span style="color:#000;font-weight:bold">:=</span> os.<span style="color:#900;font-weight:bold">Getwd</span>()  <span style="color:#998;font-style:italic">//获取当前文件路径
</span><span style="color:#998;font-style:italic"></span>    dst <span style="color:#000;font-weight:bold">:=</span> currentPath <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;/&#34;</span> <span style="color:#000;font-weight:bold">+</span> file.Filename
    log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;保存文件绝对路径:%s&#34;</span>, dst)
    c.<span style="color:#900;font-weight:bold">SaveUploadedFile</span>(file, dst)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, fmt.<span style="color:#900;font-weight:bold">Sprintf</span>(<span style="color:#d14">&#34;&#39;%s&#39; uploaded!&#34;</span>, file.Filename))
  })
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">//模拟单文件上传:
</span><span style="color:#998;font-style:italic">//curl -X POST http://localhost:8080/upload  -H &#34;Content-Type: multipart/form-data&#34; -F &#34;file=@文件名&#34;
</span></code></pre></td></tr></table>
</div>
</div><h4 id="多个文件">多个文件</h4>
<p><a href="https://github.com/gin-gonic/examples/tree/master/upload-file/multiple">完整示例代码</a>.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;fmt&#34;</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;log&#34;</span>
  <span style="color:#d14">&#34;net/http&#34;</span>
  <span style="color:#d14">&#34;os&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  <span style="color:#998;font-style:italic">// Set a lower memory limit for multipart forms (default is 32 MiB)
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 设置请求表单最大内存限制,默认是30MB
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//内部调用http请求的ParseMultipartForm方法,该方法要求传入一个字节数, 要取MultipartForm字段的数据，先使用ParseMultipartForm()方法解析Form，解析时会读取所有数据，但需要指定保存在内存中的最大字节数，剩余的字节数会保存在临时磁盘文件中
</span><span style="color:#998;font-style:italic"></span>  maxMultipartMemory <span style="color:#000;font-weight:bold">:=</span> <span style="color:#0086b3">int64</span>(<span style="color:#099">8</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">20</span>)
  log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;解析文件到内存的最大字节:%d&#34;</span>, maxMultipartMemory)
  router.MaxMultipartMemory = maxMultipartMemory  <span style="color:#998;font-style:italic">// 8 MiB
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/upload&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#998;font-style:italic">// Upload the file to specific dst.
</span><span style="color:#998;font-style:italic"></span>    currentPath, _ <span style="color:#000;font-weight:bold">:=</span> os.<span style="color:#900;font-weight:bold">Getwd</span>()  <span style="color:#998;font-style:italic">//获取当前文件路径
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// Multipart form
</span><span style="color:#998;font-style:italic"></span>    form, _ <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">MultipartForm</span>() <span style="color:#998;font-style:italic">//多文件表单
</span><span style="color:#998;font-style:italic"></span>    files <span style="color:#000;font-weight:bold">:=</span> form.File[<span style="color:#d14">&#34;upload[]&#34;</span>] <span style="color:#998;font-style:italic">//通过前端提供的键名获取文件数组
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">for</span> _, file <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">range</span> files {
      dst <span style="color:#000;font-weight:bold">:=</span> currentPath <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;/&#34;</span> <span style="color:#000;font-weight:bold">+</span> file.Filename
      log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;保存文件绝对路径:%s&#34;</span>, dst)
      <span style="color:#998;font-style:italic">// Upload the file to specific dst.
</span><span style="color:#998;font-style:italic"></span>      c.<span style="color:#900;font-weight:bold">SaveUploadedFile</span>(file, dst)
    }
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, fmt.<span style="color:#900;font-weight:bold">Sprintf</span>(<span style="color:#d14">&#34;%d files uploaded!&#34;</span>, <span style="color:#0086b3">len</span>(files)))
  })
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">//模拟多文件上传
</span><span style="color:#998;font-style:italic">//curl -X POST http://localhost:8080/upload -H &#34;Content-Type: multipart/form-data&#34; -F &#34;upload[]=@文件1&#34; -F &#34;upload[]=@文件2&#34;
</span></code></pre></td></tr></table>
</div>
</div><h3 id="路由分组">路由分组</h3>
<p>路由分组可用于新老接口兼容, 针对不同分组的路由使用不同的中间件处理逻辑等</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  <span style="color:#998;font-style:italic">// Simple group: v1  路由分组1
</span><span style="color:#998;font-style:italic"></span>  v1 <span style="color:#000;font-weight:bold">:=</span> router.<span style="color:#900;font-weight:bold">Group</span>(<span style="color:#d14">&#34;/v1&#34;</span>)
  {
    v1.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/login&#34;</span>, loginEndpoint)
    v1.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/submit&#34;</span>, submitEndpoint)
    v1.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/read&#34;</span>, readEndpoint)
  }
  <span style="color:#998;font-style:italic">// Simple group: v2  路由分组2
</span><span style="color:#998;font-style:italic"></span>  v2 <span style="color:#000;font-weight:bold">:=</span> router.<span style="color:#900;font-weight:bold">Group</span>(<span style="color:#d14">&#34;/v2&#34;</span>)
  {
    v2.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/login&#34;</span>, loginEndpoint)
    v2.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/submit&#34;</span>, submitEndpoint)
    v2.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/read&#34;</span>, readEndpoint)
  }
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="gin引擎初始化不带中间件或使用日志和异常恢复中间件">Gin引擎初始化(不带中间件或使用日志和异常恢复中间件)</h3>
<p>New()方法得到一个不使用任何中间件的Gin引擎Engine对象r</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()
</code></pre></td></tr></table>
</div>
</div><p>默认方法Default()使用Logger(日志记录器)和Recovery(异常自恢复)中间件</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#998;font-style:italic">// Default With the Logger and Recovery middleware already attached
</span><span style="color:#998;font-style:italic">// 默认方法使用Logger(日志记录器)和Recovery(异常自恢复)中间件
</span><span style="color:#998;font-style:italic"></span>r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
</code></pre></td></tr></table>
</div>
</div><h3 id="使用中间件">使用中间件</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	<span style="color:#998;font-style:italic">// Creates a router without any middleware by default
</span><span style="color:#998;font-style:italic"></span>	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()

	<span style="color:#998;font-style:italic">// Global middleware
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// Logger middleware will write the logs to gin.DefaultWriter even if you set with GIN_MODE=release.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// Logger日志中间件会将日志写到Gin默认写出器(标准输出),即使开启了release模式
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// By default gin.DefaultWriter = os.Stdout
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Use</span>(gin.<span style="color:#900;font-weight:bold">Logger</span>())

	<span style="color:#998;font-style:italic">// Recovery middleware recovers from any panics and writes a 500 if there was one.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// Recovery异常恢复中间件会在程序崩溃时恢复程序,返回状态码为500的错误
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Use</span>(gin.<span style="color:#900;font-weight:bold">Recovery</span>())

	<span style="color:#998;font-style:italic">// Per route middleware, you can add as many as you desire.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 你可以针对每个路由添加需要的中间件
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/benchmark&#34;</span>, <span style="color:#900;font-weight:bold">MyBenchLogger</span>(), benchEndpoint)

	<span style="color:#998;font-style:italic">// Authorization group
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// authorized := r.Group(&#34;/&#34;, AuthRequired())
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// exactly the same as:
</span><span style="color:#998;font-style:italic"></span>	authorized <span style="color:#000;font-weight:bold">:=</span> r.<span style="color:#900;font-weight:bold">Group</span>(<span style="color:#d14">&#34;/&#34;</span>)
	<span style="color:#998;font-style:italic">// per group middleware! in this case we use the custom created
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// AuthRequired() middleware just in the &#34;authorized&#34; group.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 也可以针对路由分组添加统一的中间件
</span><span style="color:#998;font-style:italic"></span>	authorized.<span style="color:#900;font-weight:bold">Use</span>(<span style="color:#900;font-weight:bold">AuthRequired</span>())
	{
		authorized.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/login&#34;</span>, loginEndpoint)
		authorized.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/submit&#34;</span>, submitEndpoint)
		authorized.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/read&#34;</span>, readEndpoint)

		<span style="color:#998;font-style:italic">// nested group
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// 嵌套路由组
</span><span style="color:#998;font-style:italic"></span>		testing <span style="color:#000;font-weight:bold">:=</span> authorized.<span style="color:#900;font-weight:bold">Group</span>(<span style="color:#d14">&#34;testing&#34;</span>)
		testing.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/analytics&#34;</span>, analyticsEndpoint)
	}

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="自定义程序崩溃后的处理方式邮件微信短信等告警">自定义程序崩溃后的处理方式(邮件/微信/短信等告警)</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;fmt&#34;</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;log&#34;</span>
  <span style="color:#d14">&#34;net/http&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">CustomRecovery</span>() gin.HandlerFunc {
  <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">defer</span> <span style="color:#000;font-weight:bold">func</span>() {
      <span style="color:#998;font-style:italic">//if r := recover(); r != nil {
</span><span style="color:#998;font-style:italic"></span>      <span style="color:#998;font-style:italic">//  log.Printf(&#34;崩溃信息:%s&#34;, r)
</span><span style="color:#998;font-style:italic"></span>      <span style="color:#998;font-style:italic">//}
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
      <span style="color:#000;font-weight:bold">if</span> err, ok <span style="color:#000;font-weight:bold">:=</span> <span style="color:#0086b3">recover</span>().(<span style="color:#458;font-weight:bold">string</span>); ok {
        log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;您可以在这里完成告警任务,邮件,微信等告警&#34;</span>)
        c.<span style="color:#900;font-weight:bold">String</span>(http.StatusInternalServerError, fmt.<span style="color:#900;font-weight:bold">Sprintf</span>(<span style="color:#d14">&#34;error: %s&#34;</span>, err))
      }
      c.<span style="color:#900;font-weight:bold">AbortWithStatus</span>(http.StatusInternalServerError)
    }()
    c.<span style="color:#900;font-weight:bold">Next</span>()
  }
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  <span style="color:#998;font-style:italic">// Creates a router without any middleware by default
</span><span style="color:#998;font-style:italic"></span>  r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Global middleware
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// Logger middleware will write the logs to gin.DefaultWriter even if you set with GIN_MODE=release.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// By default gin.DefaultWriter = os.Stdout
</span><span style="color:#998;font-style:italic"></span>  r.<span style="color:#900;font-weight:bold">Use</span>(gin.<span style="color:#900;font-weight:bold">Logger</span>())
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Recovery middleware recovers from any panics and writes a 500 if there was one.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//r.Use(CustomRecovery())  //使用自定义中间件处理程序崩溃
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">//使用匿名函数组成中间件,处理程序崩溃
</span><span style="color:#998;font-style:italic"></span>  r.<span style="color:#900;font-weight:bold">Use</span>(<span style="color:#000;font-weight:bold">func</span>( c <span style="color:#000;font-weight:bold">*</span>gin.Context){
    <span style="color:#000;font-weight:bold">defer</span> <span style="color:#000;font-weight:bold">func</span>() {
      <span style="color:#000;font-weight:bold">if</span> err, ok <span style="color:#000;font-weight:bold">:=</span> <span style="color:#0086b3">recover</span>().(<span style="color:#458;font-weight:bold">string</span>); ok {
        log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;您可以在这里完成告警任务,邮件,微信等告警&#34;</span>)
        c.<span style="color:#900;font-weight:bold">String</span>(http.StatusInternalServerError, fmt.<span style="color:#900;font-weight:bold">Sprintf</span>(<span style="color:#d14">&#34;error: %s&#34;</span>, err))
      }
      c.<span style="color:#900;font-weight:bold">AbortWithStatus</span>(http.StatusInternalServerError)
    }()
    c.<span style="color:#900;font-weight:bold">Next</span>()
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/panic&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#998;font-style:italic">// panic with a string -- the custom middleware could save this to a database or report it to the user
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#0086b3">panic</span>(<span style="color:#d14">&#34;程序崩溃&#34;</span>)
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">&#34;ohai&#34;</span>)
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>  r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">//模拟程序崩溃: curl http://localhost:8080/panic
</span></code></pre></td></tr></table>
</div>
</div><h3 id="怎样记录日志到文件">怎样记录日志到文件</h3>
<p>利用io.MultiWriter多写出器可以实现日志记录到文件的同时也输出到控制台</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;io&#34;</span>
  <span style="color:#d14">&#34;os&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  <span style="color:#998;font-style:italic">// Disable Console Color, you don&#39;t need console color when writing the logs to file.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 禁用控制台日志颜色,日志写到文件的时候,不需要打开控制台日志颜色
</span><span style="color:#998;font-style:italic"></span>  gin.<span style="color:#900;font-weight:bold">DisableConsoleColor</span>()
  <span style="color:#998;font-style:italic">// Logging to a file.  新建日志文件,得到文件结构,文件结构实现了写出器Writer接口
</span><span style="color:#998;font-style:italic"></span>  f, _ <span style="color:#000;font-weight:bold">:=</span> os.<span style="color:#900;font-weight:bold">Create</span>(<span style="color:#d14">&#34;gin.log&#34;</span>)
  <span style="color:#998;font-style:italic">//io.MultiWriter(多写出器方法)创建一个写出器, 将传入的多个写出器追加为一个写出器数组, 得到的写出器实现了Writer接口, 它会将需要写出的数据写出到每个写出器, 就像Unix命令tee,会将数据写入文件的同时打印到标准输出
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//配置Gin默认日志写出器为得到的多写出器
</span><span style="color:#998;font-style:italic"></span>  gin.DefaultWriter = io.<span style="color:#900;font-weight:bold">MultiWriter</span>(f)
  <span style="color:#998;font-style:italic">// Use the following code if you need to write the logs to file and console at the same time.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 使用下面的代码,将日志写入文件的同时,也输出到控制台
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// gin.DefaultWriter = io.MultiWriter(f, os.Stdout)
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;pong&#34;</span>)
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="自定义日志格式">自定义日志格式</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;fmt&#34;</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;time&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// LoggerWithFormatter middleware will write the logs to gin.DefaultWriter
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// By default gin.DefaultWriter = os.Stdout
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// type LogFormatter func(params LogFormatterParams) string 这里的LogFormatterParams是一个格式化日志参数的结构体
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">Use</span>(gin.<span style="color:#900;font-weight:bold">LoggerWithFormatter</span>(<span style="color:#000;font-weight:bold">func</span>(param gin.LogFormatterParams) <span style="color:#458;font-weight:bold">string</span> {
    <span style="color:#998;font-style:italic">// your custom format
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// 127.0.0.1 - [Sun, 22 Nov 2020 17:09:53 CST] &#34;GET /ping HTTP/1.1 200 56.113µs &#34;curl/7.64.1&#34; &#34;
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">return</span> fmt.<span style="color:#900;font-weight:bold">Sprintf</span>(<span style="color:#d14">&#34;%s - [%s] \&#34;%s %s %s %d %s \&#34;%s\&#34; %s\&#34;\n&#34;</span>,
      param.ClientIP,                       <span style="color:#998;font-style:italic">//请求客户端的IP地址
</span><span style="color:#998;font-style:italic"></span>      param.TimeStamp.<span style="color:#900;font-weight:bold">Format</span>(time.RFC1123), <span style="color:#998;font-style:italic">//请求时间
</span><span style="color:#998;font-style:italic"></span>      param.Method,                         <span style="color:#998;font-style:italic">//请求方法
</span><span style="color:#998;font-style:italic"></span>      param.Path,                           <span style="color:#998;font-style:italic">//路由路径
</span><span style="color:#998;font-style:italic"></span>      param.Request.Proto,                  <span style="color:#998;font-style:italic">//请求协议
</span><span style="color:#998;font-style:italic"></span>      param.StatusCode,                     <span style="color:#998;font-style:italic">//http响应码
</span><span style="color:#998;font-style:italic"></span>      param.Latency,                        <span style="color:#998;font-style:italic">//请求到响应的延时
</span><span style="color:#998;font-style:italic"></span>      param.Request.<span style="color:#900;font-weight:bold">UserAgent</span>(),            <span style="color:#998;font-style:italic">//客户端代理程序
</span><span style="color:#998;font-style:italic"></span>      param.ErrorMessage,                   <span style="color:#998;font-style:italic">//如果有错误,也打印错误信息
</span><span style="color:#998;font-style:italic"></span>    )
  }))
  router.<span style="color:#900;font-weight:bold">Use</span>(gin.<span style="color:#900;font-weight:bold">Recovery</span>())
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;pong&#34;</span>)
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">//模拟请求测试: curl http://localhost:8080/ping
</span></code></pre></td></tr></table>
</div>
</div><p><strong>参考输出</strong></p>
<pre><code>::1 - [Fri, 07 Dec 2018 17:04:38 JST] &quot;GET /ping HTTP/1.1 200 122.767µs &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.80 Safari/537.36&quot; &quot;
</code></pre><h3 id="控制日志输出颜色">控制日志输出颜色</h3>
<p>默认情况, 日志输出到控制台的颜色取决于使用的虚拟终端TTY的颜色方案.</p>
<p>禁用日志颜色:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
    <span style="color:#998;font-style:italic">// Disable log&#39;s color
</span><span style="color:#998;font-style:italic"></span>    gin.<span style="color:#900;font-weight:bold">DisableConsoleColor</span>()
    
    <span style="color:#998;font-style:italic">// Creates a gin router with default middleware:
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// logger and recovery (crash-free) middleware
</span><span style="color:#998;font-style:italic"></span>    router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
    
    router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
        c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;pong&#34;</span>)
    })
    
    router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><p>打开日志颜色:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
    <span style="color:#998;font-style:italic">// Force log&#39;s color
</span><span style="color:#998;font-style:italic"></span>    gin.<span style="color:#900;font-weight:bold">ForceConsoleColor</span>()
    
    <span style="color:#998;font-style:italic">// Creates a gin router with default middleware:
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// logger and recovery (crash-free) middleware
</span><span style="color:#998;font-style:italic"></span>    router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
    
    router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
        c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;pong&#34;</span>)
    })
    
    router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">//模拟请求测试: curl http://localhost:8080/ping
</span></code></pre></td></tr></table>
</div>
</div><h3 id="模型绑定和验证">模型绑定和验证</h3>
<p>使用模型绑定来绑定请求体到一个Go类型上. 目前支持JSON,XML,YAML以及标准表单(如foo=bar&amp;boo=baz)的绑定.</p>
<p>Gin使用<a href="https://github.com/go-playground/validator"><strong>go-playground/validator/v10</strong></a>包来验证请求, 关于tags在验证中使用详见<a href="https://godoc.org/github.com/go-playground/validator#hdr-Baked_In_Validators_and_Tags">Tags</a></p>
<p>注意:绑定前请确认结构体中需要绑定的字段标签与绑定类型一致,比如绑定JSON,设置标签:<code> json:&quot;fieldname&quot;</code></p>
<p>Gin提供两种方式(类型)来完成绑定:</p>
<ul>
<li><strong>方式一</strong> - Must bind
<ul>
<li><strong>方法</strong> - <code>Bind</code>, <code>BindJSON</code>, <code>BindXML</code>, <code>BindQuery</code>, <code>BindYAML</code>, <code>BindHeader</code></li>
<li><strong>特点</strong> - 这些方法底层使用<code>MustBindWith</code>方法. 如果出现绑定错误, 请求将以状态码400返回失败信息:<code>c.AbortWithError(400, err).SetType(ErrorTypeBind)</code>, 响应中设置Content-Type头为text/plain; charset=utf-8.如果手动设置响应码,会警告响应头已经设置,比如提示: <code>[GIN-debug] [WARNING] Headers were already written. Wanted to override status code 400 with 422</code>, 如果想要更好的控制这些行为,建议使用下面对应的ShoudBind方法.</li>
</ul>
</li>
<li><strong>方式二</strong> - Should bind
<ul>
<li><strong>方法</strong> - <code>ShouldBind</code>, <code>ShouldBindJSON</code>, <code>ShouldBindXML</code>, <code>ShouldBindQuery</code>, <code>ShouldBindYAML</code>, <code>ShouldBindHeader</code></li>
<li><strong>特点</strong> - 这些方法底层使用<code>ShouldBindWith</code>. 如果出现绑定错误, 会返回错误, 开发者可以控制和恰当的处理这些错误.</li>
</ul>
</li>
</ul>
<p>当使用绑定方法时, Gin尝试根据类型头<code>Content-Type header</code>自动推断要使用的绑定器. 如果你已经确认需要绑定的类型,可以直接使用底层的<code>MustBindWith</code>或<code>ShouldBindWith</code>方法.</p>
<p>你也可以针对特殊的字段指定required标签值, 如果某个字段指定了:<code>binding:&quot;required&quot;</code>标签, 但是在绑定时该字段为空会返回错误.</p>
<p>如以下代码绑定JSON:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;net/http&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">// Binding from JSON
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">type</span> Login <span style="color:#000;font-weight:bold">struct</span> {
  User <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;user&#34; json:&#34;user&#34; xml:&#34;user&#34;  binding:&#34;required&#34;`</span> <span style="color:#998;font-style:italic">//分别定义form,json,xml,binding等标签
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//Password string `form:&#34;password&#34; json:&#34;password&#34; xml:&#34;password&#34; binding:&#34;required&#34;`
</span><span style="color:#998;font-style:italic"></span>  Password <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;password&#34; json:&#34;password&#34; xml:&#34;password&#34; binding:&#34;-&#34;`</span>
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Example for binding JSON ({&#34;user&#34;: &#34;manu&#34;, &#34;password&#34;: &#34;123&#34;})
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/loginJSON&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">var</span> json Login
    <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindJSON</span>(<span style="color:#000;font-weight:bold">&amp;</span>json); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusBadRequest, gin.H{<span style="color:#d14">&#34;error&#34;</span>: err.<span style="color:#900;font-weight:bold">Error</span>()})
      <span style="color:#000;font-weight:bold">return</span>
    }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    <span style="color:#000;font-weight:bold">if</span> json.User <span style="color:#000;font-weight:bold">!=</span> <span style="color:#d14">&#34;manu&#34;</span> <span style="color:#000;font-weight:bold">||</span> json.Password <span style="color:#000;font-weight:bold">!=</span> <span style="color:#d14">&#34;123&#34;</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusUnauthorized, gin.H{<span style="color:#d14">&#34;status&#34;</span>: <span style="color:#d14">&#34;unauthorized&#34;</span>})
      <span style="color:#000;font-weight:bold">return</span>
    }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;status&#34;</span>: <span style="color:#d14">&#34;you are logged in&#34;</span>})
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Example for binding XML (
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//  &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//  &lt;root&gt;
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//    &lt;user&gt;user&lt;/user&gt;
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//    &lt;password&gt;123&lt;/password&gt;
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//  &lt;/root&gt;)
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/loginXML&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">var</span> xml Login
    <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindXML</span>(<span style="color:#000;font-weight:bold">&amp;</span>xml); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusBadRequest, gin.H{<span style="color:#d14">&#34;error&#34;</span>: err.<span style="color:#900;font-weight:bold">Error</span>()})
      <span style="color:#000;font-weight:bold">return</span>
    }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    <span style="color:#000;font-weight:bold">if</span> xml.User <span style="color:#000;font-weight:bold">!=</span> <span style="color:#d14">&#34;manu&#34;</span> <span style="color:#000;font-weight:bold">||</span> xml.Password <span style="color:#000;font-weight:bold">!=</span> <span style="color:#d14">&#34;123&#34;</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusUnauthorized, gin.H{<span style="color:#d14">&#34;status&#34;</span>: <span style="color:#d14">&#34;unauthorized&#34;</span>})
      <span style="color:#000;font-weight:bold">return</span>
    }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;status&#34;</span>: <span style="color:#d14">&#34;you are logged in&#34;</span>})
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Example for binding a HTML form (user=manu&amp;password=123)
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/loginForm&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">var</span> form Login
    <span style="color:#998;font-style:italic">// This will infer what binder to use depending on the content-type header.
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBind</span>(<span style="color:#000;font-weight:bold">&amp;</span>form); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusBadRequest, gin.H{<span style="color:#d14">&#34;error&#34;</span>: err.<span style="color:#900;font-weight:bold">Error</span>()})
      <span style="color:#000;font-weight:bold">return</span>
    }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    <span style="color:#000;font-weight:bold">if</span> form.User <span style="color:#000;font-weight:bold">!=</span> <span style="color:#d14">&#34;manu&#34;</span> <span style="color:#000;font-weight:bold">||</span> form.Password <span style="color:#000;font-weight:bold">!=</span> <span style="color:#d14">&#34;123&#34;</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusUnauthorized, gin.H{<span style="color:#d14">&#34;status&#34;</span>: <span style="color:#d14">&#34;unauthorized&#34;</span>})
      <span style="color:#000;font-weight:bold">return</span>
    }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;status&#34;</span>: <span style="color:#d14">&#34;you are logged in&#34;</span>})
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">//模拟请求: curl -v -X POST http://localhost:8080/loginJSON -H &#39;content-type: application/json&#39; -d &#39;{ &#34;user&#34;: &#34;manu&#34;, &#34;password&#34;: &#34;123&#34; }&#39;
</span></code></pre></td></tr></table>
</div>
</div><p><strong>请求示例</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ curl -v -X POST <span style="color:#d14">\
</span><span style="color:#d14"></span>  http://localhost:8080/loginJSON <span style="color:#d14">\
</span><span style="color:#d14"></span>  -H <span style="color:#d14">&#39;content-type: application/json&#39;</span> <span style="color:#d14">\
</span><span style="color:#d14"></span>  -d <span style="color:#d14">&#39;{ &#34;user&#34;: &#34;manu&#34; }&#39;</span>
&gt; POST /loginJSON HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt; content-type: application/json
&gt; Content-Length: <span style="color:#099">18</span>
&gt;
* upload completely sent off: <span style="color:#099">18</span> out of <span style="color:#099">18</span> bytes
&lt; HTTP/1.1 <span style="color:#099">400</span> Bad Request
&lt; Content-Type: application/json; <span style="color:#008080">charset</span><span style="color:#000;font-weight:bold">=</span>utf-8
&lt; Date: Fri, <span style="color:#099">04</span> Aug <span style="color:#099">2017</span> 03:51:31 GMT
&lt; Content-Length: <span style="color:#099">100</span>
&lt;
<span style="color:#000;font-weight:bold">{</span><span style="color:#d14">&#34;error&#34;</span>:<span style="color:#d14">&#34;Key: &#39;Login.Password&#39; Error:Field validation for &#39;Password&#39; failed on the &#39;required&#39; tag&#34;</span><span style="color:#000;font-weight:bold">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>跳过验证</strong></p>
<p>跳过验证: 与<code>binding:&quot;required&quot;</code>标签对应的是<code>binding:&quot;-&quot;</code>, 表示该字段不做绑定, 所以绑定时该字段为空不会报错.</p>
<h3 id="自定义验证器">自定义验证器</h3>
<p>你也可以自己注册一个自定义验证器,  <a href="https://github.com/gin-gonic/examples/tree/master/custom-validation/server.go">示例代码</a>.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;net/http&#34;</span>
  <span style="color:#d14">&#34;time&#34;</span>
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin/binding&#34;</span>
  <span style="color:#d14">&#34;github.com/go-playground/validator/v10&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">// Booking contains binded and validated data.
</span><span style="color:#998;font-style:italic">// Booking结构中定义了包含绑定器和日期验证器标签
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">type</span> Booking <span style="color:#000;font-weight:bold">struct</span> {
  CheckIn  time.Time <span style="color:#d14">`form:&#34;check_in&#34; binding:&#34;required,bookabledate&#34; time_format:&#34;2006-01-02&#34;`</span>  <span style="color:#998;font-style:italic">//登记时间
</span><span style="color:#998;font-style:italic"></span>  CheckOut time.Time <span style="color:#d14">`form:&#34;check_out&#34; binding:&#34;required,gtfield=CheckIn&#34; time_format:&#34;2006-01-02&#34;`</span>  <span style="color:#998;font-style:italic">//gtfield=CheckIn表示结账时间必须大于登记时间
</span><span style="color:#998;font-style:italic"></span>}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">// 定义日期验证器
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">var</span> bookableDate validator.Func = <span style="color:#000;font-weight:bold">func</span>(fl validator.FieldLevel) <span style="color:#458;font-weight:bold">bool</span> {
  date, ok <span style="color:#000;font-weight:bold">:=</span> fl.<span style="color:#900;font-weight:bold">Field</span>().<span style="color:#900;font-weight:bold">Interface</span>().(time.Time)  <span style="color:#998;font-style:italic">//利用反射获取到字段值 -&gt; 转为接口 -&gt; 类型断言(时间类型)
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">if</span> ok {
    today <span style="color:#000;font-weight:bold">:=</span> time.<span style="color:#900;font-weight:bold">Now</span>()
    <span style="color:#000;font-weight:bold">if</span> today.<span style="color:#900;font-weight:bold">After</span>(date) {  <span style="color:#998;font-style:italic">//如果当前时间在checkIn字段时间之后,返回false,即登记时间不能早于当前的时间
</span><span style="color:#998;font-style:italic"></span>      <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">false</span>
    }
  }
  <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">true</span>
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  route <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  <span style="color:#998;font-style:italic">//对binding.Validator.Engine()接口进行类型断言,断言类型为Validate结构,如果断言成功,就将自定义的验证器注册到Gin内部
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">if</span> v, ok <span style="color:#000;font-weight:bold">:=</span> binding.Validator.<span style="color:#900;font-weight:bold">Engine</span>().(<span style="color:#000;font-weight:bold">*</span>validator.Validate); ok {
    <span style="color:#998;font-style:italic">// - if the key already exists, the previous validation function will be replaced. 该注册方法会将已经存在的验证器替换
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// - this method is not thread-safe it is intended that these all be registered prior to any validation
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// 注册方法不是线程安全的, 在验证开始前,需要保证所有的验证器都注册成功
</span><span style="color:#998;font-style:italic"></span>    v.<span style="color:#900;font-weight:bold">RegisterValidation</span>(<span style="color:#d14">&#34;bookabledate&#34;</span>, bookableDate)
  }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  route.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/bookable&#34;</span>, getBookable)
  route.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8085&#34;</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">getBookable</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
  <span style="color:#000;font-weight:bold">var</span> b Booking
  <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindWith</span>(<span style="color:#000;font-weight:bold">&amp;</span>b, binding.Query); err <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;message&#34;</span>: <span style="color:#d14">&#34;Booking dates are valid!&#34;</span>})
  } <span style="color:#000;font-weight:bold">else</span> {
    c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusBadRequest, gin.H{<span style="color:#d14">&#34;error&#34;</span>: err.<span style="color:#900;font-weight:bold">Error</span>()})
  }
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">//模拟请求:
</span><span style="color:#998;font-style:italic">// 登记时间和结账时间符合条件
</span><span style="color:#998;font-style:italic">//$ curl &#34;localhost:8085/bookable?check_in=2030-04-16&amp;check_out=2030-04-17&#34;
</span><span style="color:#998;font-style:italic">//{&#34;message&#34;:&#34;Booking dates are valid!&#34;}
</span><span style="color:#998;font-style:italic">//
</span><span style="color:#998;font-style:italic">// 登记时间在结账时间之后, 不满足gtfield校验规则
</span><span style="color:#998;font-style:italic">//$ curl &#34;localhost:8085/bookable?check_in=2030-03-10&amp;check_out=2030-03-09&#34;
</span><span style="color:#998;font-style:italic">//{&#34;error&#34;:&#34;Key: &#39;Booking.CheckOut&#39; Error:Field validation for &#39;CheckOut&#39; failed on the &#39;gtfield&#39; tag&#34;}
</span><span style="color:#998;font-style:italic">//
</span><span style="color:#998;font-style:italic">// 登记时间在当前时间之前,不满足自定义的验证器
</span><span style="color:#998;font-style:italic">//$ curl &#34;localhost:8085/bookable?check_in=2000-03-09&amp;check_out=2000-03-10&#34;
</span><span style="color:#998;font-style:italic">//{&#34;error&#34;:&#34;Key: &#39;Booking.CheckIn&#39; Error:Field validation for &#39;CheckIn&#39; failed on the &#39;bookabledate&#39; tag&#34;}%
</span></code></pre></td></tr></table>
</div>
</div><pre><code class="language-console" data-lang="console">$ curl &quot;localhost:8085/bookable?check_in=2030-04-16&amp;check_out=2030-04-17&quot;
{&quot;message&quot;:&quot;Booking dates are valid!&quot;}

$ curl &quot;localhost:8085/bookable?check_in=2030-03-10&amp;check_out=2030-03-09&quot;
{&quot;error&quot;:&quot;Key: 'Booking.CheckOut' Error:Field validation for 'CheckOut' failed on the 'gtfield' tag&quot;}

$ curl &quot;localhost:8085/bookable?check_in=2000-03-09&amp;check_out=2000-03-10&quot;
{&quot;error&quot;:&quot;Key: 'Booking.CheckIn' Error:Field validation for 'CheckIn' failed on the 'bookabledate' tag&quot;}%    
</code></pre><p>另外<a href="https://github.com/go-playground/validator/releases/tag/v8.7">结构体级别的验证</a>采用如下的方式注册, v.RegisterStructValidation(UserStructLevelValidation, User{}),  请参考<a href="https://github.com/gin-gonic/examples/tree/master/struct-lvl-validations">结构体级别验证示例</a></p>
<h3 id="只绑定查询字符串">只绑定查询字符串</h3>
<p>使用<code>SholdBindQuery</code>方法只绑定查询参数, 而不会绑定post的数据. 请参<a href="https://github.com/gin-gonic/gin/issues/742#issuecomment-315953017">详情</a>.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;log&#34;</span>
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">type</span> Person <span style="color:#000;font-weight:bold">struct</span> {
  Name    <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;name&#34;`</span>
  Address <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;address&#34;`</span>
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  route <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  route.<span style="color:#900;font-weight:bold">Any</span>(<span style="color:#d14">&#34;/testing&#34;</span>, startPage)
  route.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8085&#34;</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">startPage</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
  <span style="color:#000;font-weight:bold">var</span> person Person
  <span style="color:#998;font-style:italic">// ShouldBindQuery is a shortcut for c.ShouldBindWith(obj, binding.Query)
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// ShouldBindQuery是c.ShouldBindWith(obj, binding.Query)方法的一个快捷绑定方法, 该方法只绑定请求字符串query string,而忽略Post提交的表单数据
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">if</span> c.<span style="color:#900;font-weight:bold">ShouldBindQuery</span>(<span style="color:#000;font-weight:bold">&amp;</span>person) <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    log.<span style="color:#900;font-weight:bold">Println</span>(<span style="color:#d14">&#34;====== Only Bind By Query String ======&#34;</span>)
    log.<span style="color:#900;font-weight:bold">Println</span>(person.Name)
    log.<span style="color:#900;font-weight:bold">Println</span>(person.Address)
  }
  c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;Success&#34;</span>)
}
<span style="color:#998;font-style:italic">//only bind query 模拟查询字符串请求
</span><span style="color:#998;font-style:italic">//curl -X GET &#34;localhost:8085/testing?name=eason&amp;address=xyz&#34;
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">//only bind query string, ignore form data 模拟查询字符串请求和Post表单,这里的表单会被忽略
</span><span style="color:#998;font-style:italic">//curl -X POST &#34;localhost:8085/testing?name=eason&amp;address=xyz&#34; --data &#39;name=ignore&amp;address=ignore&#39; -H &#34;Content-Type:application/x-www-form-urlencoded
</span></code></pre></td></tr></table>
</div>
</div><h3 id="绑定查询字符串或post表单数据">绑定查询字符串或Post表单数据</h3>
<p><a href="https://github.com/gin-gonic/gin/issues/742#issuecomment-264681292">详情请参考</a>.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;log&#34;</span>
  <span style="color:#d14">&#34;time&#34;</span>
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">type</span> Person <span style="color:#000;font-weight:bold">struct</span> {
  Name       <span style="color:#458;font-weight:bold">string</span>    <span style="color:#d14">`form:&#34;name&#34;`</span>
  Address    <span style="color:#458;font-weight:bold">string</span>    <span style="color:#d14">`form:&#34;address&#34;`</span>
  Birthday   time.Time <span style="color:#d14">`form:&#34;birthday&#34; time_format:&#34;2006-01-02&#34; time_utc:&#34;1&#34;`</span>
  CreateTime time.Time <span style="color:#d14">`form:&#34;createTime&#34; time_format:&#34;unixNano&#34;`</span>
  UnixTime   time.Time <span style="color:#d14">`form:&#34;unixTime&#34; time_format:&#34;unix&#34;`</span>
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  route <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  <span style="color:#998;font-style:italic">//route.GET(&#34;/testing&#34;, startPage)           //使用GET
</span><span style="color:#998;font-style:italic"></span>  route.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/testing&#34;</span>, startPage)  <span style="color:#998;font-style:italic">//使用POST
</span><span style="color:#998;font-style:italic"></span>  route.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8085&#34;</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">startPage</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
  <span style="color:#000;font-weight:bold">var</span> person Person
  <span style="color:#998;font-style:italic">// If `GET`, only `Form` binding engine (`query`) used.  如果路由是GET方法,则只使用查询字符串引擎绑定
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// If `POST`, first checks the `content-type` for `JSON` or `XML`, then uses `Form` (`form-data`).
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// See more at https://github.com/gin-gonic/gin/blob/master/binding/binding.go#L48
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//如果是POST方式, ShouldBind方法检查请求类型头Content-Type来自动选择绑定引擎,比如Json/XML
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">if</span> c.<span style="color:#900;font-weight:bold">ShouldBind</span>(<span style="color:#000;font-weight:bold">&amp;</span>person) <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    log.<span style="color:#900;font-weight:bold">Println</span>(person.Name)
    log.<span style="color:#900;font-weight:bold">Println</span>(person.Address)
    log.<span style="color:#900;font-weight:bold">Println</span>(person.Birthday)
    log.<span style="color:#900;font-weight:bold">Println</span>(person.CreateTime)
    log.<span style="color:#900;font-weight:bold">Println</span>(person.UnixTime)
  }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">//if c.BindJSON(&amp;person) == nil {
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//  log.Println(&#34;====== Bind By JSON ======&#34;)
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//  log.Println(person.Name)
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//  log.Println(person.Address)
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//}
</span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">​</span>
  c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;Success&#34;</span>)
}
<span style="color:#998;font-style:italic">//模拟查询字符串参数请求:
</span><span style="color:#998;font-style:italic">//curl -X GET &#34;localhost:8085/testing?name=appleboy&amp;address=xyz&amp;birthday=1992-03-15&amp;createTime=1562400033000000123&amp;unixTime=1562400033&#34;
</span><span style="color:#998;font-style:italic">//模拟Post Json请求
</span><span style="color:#998;font-style:italic">//curl -X POST localhost:8085/testing --data &#39;{&#34;name&#34;:&#34;JJ&#34;, &#34;address&#34;:&#34;xyz&#34;}&#39; -H &#34;Content-Type:application/json&#34;
</span></code></pre></td></tr></table>
</div>
</div><p>Test it with:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ curl -X GET <span style="color:#d14">&#34;localhost:8085/testing?name=appleboy&amp;address=xyz&amp;birthday=1992-03-15&amp;createTime=1562400033000000123&amp;unixTime=1562400033&#34;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="绑定uri">绑定URI</h3>
<p>将结构体中标签指定的字段与URI中对应的字段进行绑定, 请参考<a href="https://github.com/gin-gonic/gin/issues/846">详情</a>.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">type</span> Person <span style="color:#000;font-weight:bold">struct</span> {
  ID <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`uri:&#34;id&#34; binding:&#34;required,uuid&#34;`</span>  <span style="color:#998;font-style:italic">//指定URI标签
</span><span style="color:#998;font-style:italic"></span>  Name <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`uri:&#34;name&#34; binding:&#34;required&#34;`</span>
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  route <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  <span style="color:#998;font-style:italic">//下面的URI中的name和id与Person结构中的标签分别对应
</span><span style="color:#998;font-style:italic"></span>  route.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/:name/:id&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">var</span> person Person
    <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindUri</span>(<span style="color:#000;font-weight:bold">&amp;</span>person); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">400</span>, gin.H{<span style="color:#d14">&#34;msg&#34;</span>: err})
      <span style="color:#000;font-weight:bold">return</span>
    }
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{<span style="color:#d14">&#34;name&#34;</span>: person.Name, <span style="color:#d14">&#34;uuid&#34;</span>: person.ID})
  })
  route.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8088&#34;</span>)
}
<span style="color:#998;font-style:italic">//模拟请求
</span><span style="color:#998;font-style:italic">//curl -v localhost:8088/thinkerou/987fbc97-4bed-5078-9f07-9141ba07c9f3
</span><span style="color:#998;font-style:italic">//curl -v localhost:8088/thinkerou/not-uuid
</span></code></pre></td></tr></table>
</div>
</div><p>模拟请求测试:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ curl -v localhost:8088/thinkerou/987fbc97-4bed-5078-9f07-9141ba07c9f3
$ curl -v localhost:8088/thinkerou/not-uuid
</code></pre></td></tr></table>
</div>
</div><h3 id="绑定请求头">绑定请求头</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;fmt&#34;</span>
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">type</span> testHeader <span style="color:#000;font-weight:bold">struct</span> {
  Rate   <span style="color:#458;font-weight:bold">int</span>    <span style="color:#d14">`header:&#34;Rate&#34;`</span>   <span style="color:#998;font-style:italic">//结构中添加header标签
</span><span style="color:#998;font-style:italic"></span>  Domain <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`header:&#34;Domain&#34;`</span>
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
<span style="color:#a61717;background-color:#e3d2d2">​</span>    h <span style="color:#000;font-weight:bold">:=</span> testHeader{}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    <span style="color:#998;font-style:italic">//ShouldBindHeader是c.ShouldBindWith(obj, binding.Header)的快捷方法
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindHeader</span>(<span style="color:#000;font-weight:bold">&amp;</span>h); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
      c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, err)
    }
<span style="color:#a61717;background-color:#e3d2d2">​</span>
    fmt.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;%#v\n&#34;</span>, h)
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{<span style="color:#d14">&#34;Rate&#34;</span>: h.Rate, <span style="color:#d14">&#34;Domain&#34;</span>: h.Domain})
  })
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  r.<span style="color:#900;font-weight:bold">Run</span>()
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">//模拟请求
</span><span style="color:#998;font-style:italic">// curl -H &#34;rate:300&#34; -H &#34;domain:music&#34; http://localhost:8080/
</span><span style="color:#998;font-style:italic">// 参考输出:
</span><span style="color:#998;font-style:italic">// {&#34;Domain&#34;:&#34;music&#34;,&#34;Rate&#34;:300}
</span></code></pre></td></tr></table>
</div>
</div><h3 id="绑定html复选框">绑定HTML复选框</h3>
<p>请参考<a href="https://github.com/gin-gonic/gin/issues/129#issuecomment-124260092">详情</a>, 将html与main.go放到一个目录,执行go run main.go运行后, 访问http://localhost:8080,勾选复选框,然后提交测试</p>
<p>main.go</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">type</span> myForm <span style="color:#000;font-weight:bold">struct</span> {
  Colors []<span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;colors[]&#34;`</span> <span style="color:#998;font-style:italic">//标签中的colors[]数组切片与html文件中的name=&#34;colors[]&#34;对应
</span><span style="color:#998;font-style:italic"></span>}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">//LoadHTMLGlob采用通配符模式匹配HTML文件,并将内容进行渲染,提供给前端访问
</span><span style="color:#998;font-style:italic"></span>  r.<span style="color:#900;font-weight:bold">LoadHTMLGlob</span>(<span style="color:#d14">&#34;*.html&#34;</span>)
<span style="color:#a61717;background-color:#e3d2d2">​</span>  r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, indexHandler)
  r.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/&#34;</span>, formHandler)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">indexHandler</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
  c.<span style="color:#900;font-weight:bold">HTML</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;form.html&#34;</span>, <span style="color:#000;font-weight:bold">nil</span>)
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">formHandler</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
  <span style="color:#000;font-weight:bold">var</span> fakeForm myForm
  c.<span style="color:#900;font-weight:bold">Bind</span>(<span style="color:#000;font-weight:bold">&amp;</span>fakeForm) <span style="color:#998;font-style:italic">//Bind方法根据请求头类型Content-Type, 自动选择合适的绑定引擎,如Json/XML
</span><span style="color:#998;font-style:italic"></span>  c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{<span style="color:#d14">&#34;color&#34;</span>: fakeForm.Colors})
}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#998;font-style:italic">//将html与main.go放到一个目录,执行go run main.go运行后, 访问http://localhost:8080,勾选复选框,然后提交测试
</span></code></pre></td></tr></table>
</div>
</div><p>form.html</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#000080">form</span> <span style="color:#008080">action</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;/&#34;</span> <span style="color:#008080">method</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;POST&#34;</span>&gt;
    &lt;<span style="color:#000080">p</span>&gt;Check some colors&lt;/<span style="color:#000080">p</span>&gt;
    &lt;<span style="color:#000080">label</span> <span style="color:#008080">for</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;red&#34;</span>&gt;Red&lt;/<span style="color:#000080">label</span>&gt;
    &lt;<span style="color:#000080">input</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;checkbox&#34;</span> <span style="color:#008080">name</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;colors[]&#34;</span> <span style="color:#008080">value</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;red&#34;</span> <span style="color:#008080">id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;red&#34;</span>&gt;
    &lt;<span style="color:#000080">label</span> <span style="color:#008080">for</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;green&#34;</span>&gt;Green&lt;/<span style="color:#000080">label</span>&gt;
    &lt;<span style="color:#000080">input</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;checkbox&#34;</span> <span style="color:#008080">name</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;colors[]&#34;</span> <span style="color:#008080">value</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;green&#34;</span> <span style="color:#008080">id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;green&#34;</span>&gt;
    &lt;<span style="color:#000080">label</span> <span style="color:#008080">for</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;blue&#34;</span>&gt;Blue&lt;/<span style="color:#000080">label</span>&gt;
    &lt;<span style="color:#000080">input</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;checkbox&#34;</span> <span style="color:#008080">name</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;colors[]&#34;</span> <span style="color:#008080">value</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;blue&#34;</span> <span style="color:#008080">id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;blue&#34;</span>&gt;
    &lt;<span style="color:#000080">input</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;submit&#34;</span>&gt;
&lt;/<span style="color:#000080">form</span>&gt;
</code></pre></td></tr></table>
</div>
</div><p>结果:</p>
<pre><code>{&quot;color&quot;:[&quot;red&quot;,&quot;green&quot;,&quot;blue&quot;]}
</code></pre><h3 id="绑定multiparturlencoded类型的表单">绑定Multipart/Urlencoded类型的表单</h3>
<p>使用<code>ShouldBind</code>方法结合结构体标签, 以及mime/multipart包完成多部分类型表单数据<code>multipart/form-data</code>或URL编码类型表单<code>application/x-www-form-urlencoded</code>数据进行绑定:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">import</span> (
  <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
  <span style="color:#d14">&#34;mime/multipart&#34;</span>
  <span style="color:#d14">&#34;net/http&#34;</span>
)
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">type</span> ProfileForm <span style="color:#000;font-weight:bold">struct</span> {
  Name   <span style="color:#458;font-weight:bold">string</span>                <span style="color:#d14">`form:&#34;name&#34; binding:&#34;required&#34;`</span>
  Avatar <span style="color:#000;font-weight:bold">*</span>multipart.FileHeader <span style="color:#d14">`form:&#34;avatar&#34; binding:&#34;required&#34;`</span>
<span style="color:#a61717;background-color:#e3d2d2">​</span>
  <span style="color:#998;font-style:italic">// or for multiple files
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// Avatars []*multipart.FileHeader `form:&#34;avatar&#34; binding:&#34;required&#34;`
</span><span style="color:#998;font-style:italic"></span>}
<span style="color:#a61717;background-color:#e3d2d2">​</span>
<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
  router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
  router.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/profile&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#998;font-style:italic">// you can bind multipart form with explicit binding declaration:  可以使用显示申明的方式,即用ShouldBindWith(&amp;from, binding.Form)方法来绑定多部分类型表单multipart form
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// c.ShouldBindWith(&amp;form, binding.Form)
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// or you can simply use autobinding with ShouldBind method:
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">var</span> form ProfileForm
    <span style="color:#998;font-style:italic">// in this case proper binding will be automatically selected
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">// 这里使用ShouldBind方法自动选择绑定器进行绑定
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBind</span>(<span style="color:#000;font-weight:bold">&amp;</span>form); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
      c.<span style="color:#900;font-weight:bold">String</span>(http.StatusBadRequest, <span style="color:#d14">&#34;bad request&#34;</span>)
      <span style="color:#000;font-weight:bold">return</span>
    }
    <span style="color:#998;font-style:italic">//保存上传的表单文件到指定的目标文件
</span><span style="color:#998;font-style:italic"></span>    err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">SaveUploadedFile</span>(form.Avatar, form.Avatar.Filename)
    <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
      c.<span style="color:#900;font-weight:bold">String</span>(http.StatusInternalServerError, <span style="color:#d14">&#34;unknown error&#34;</span>)
      <span style="color:#000;font-weight:bold">return</span>
    }
    <span style="color:#998;font-style:italic">// db.Save(&amp;form)
</span><span style="color:#998;font-style:italic"></span>    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">&#34;ok&#34;</span>)
  })
  router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">//模拟测试:
</span><span style="color:#998;font-style:italic">//curl -X POST -v --form name=user --form &#34;avatar=@./avatar.png&#34; http://localhost:8080/profile
</span></code></pre></td></tr></table>
</div>
</div><p>模拟测试:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ curl -X POST -v --form <span style="color:#008080">name</span><span style="color:#000;font-weight:bold">=</span>user --form <span style="color:#d14">&#34;avatar=@./avatar.png&#34;</span> http://localhost:8080/profile
</code></pre></td></tr></table>
</div>
</div><h3 id="xmljsonyamlprotobuf等渲染">XML,JSON,YAML,ProtoBuf等渲染</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;github.com/gin-gonic/gin/testdata/protoexample&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	<span style="color:#998;font-style:italic">// gin.H is a shortcut for map[string]interface{}
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// gin.H对象是一个map映射,键名为字符串类型, 键值是接口,所以可以传递所有的类型
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someJSON&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;message&#34;</span>: <span style="color:#d14">&#34;hey&#34;</span>, <span style="color:#d14">&#34;status&#34;</span>: http.StatusOK})
	})

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/moreJSON&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		<span style="color:#998;font-style:italic">// You also can use a struct
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#000;font-weight:bold">var</span> msg <span style="color:#000;font-weight:bold">struct</span> {
			Name    <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`json:&#34;user&#34;`</span>
			Message <span style="color:#458;font-weight:bold">string</span>
			Number  <span style="color:#458;font-weight:bold">int</span>
		}
		msg.Name = <span style="color:#d14">&#34;Lena&#34;</span>
		msg.Message = <span style="color:#d14">&#34;hey&#34;</span>
		msg.Number = <span style="color:#099">123</span>
		<span style="color:#998;font-style:italic">// Note that msg.Name becomes &#34;user&#34; in the JSON
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// Will output  :   {&#34;user&#34;: &#34;Lena&#34;, &#34;Message&#34;: &#34;hey&#34;, &#34;Number&#34;: 123}
</span><span style="color:#998;font-style:italic"></span>
		<span style="color:#998;font-style:italic">//JSON serializes the given struct as JSON into the response body. It also sets the Content-Type as &#34;application/json&#34;.
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">//JSON方法将给定的结构序列化为JSON到响应体, 并设置内容类型Content-Type为:&#34;application/json&#34;
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, msg)
	})

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someXML&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">XML</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;message&#34;</span>: <span style="color:#d14">&#34;hey&#34;</span>, <span style="color:#d14">&#34;status&#34;</span>: http.StatusOK})
	})

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someYAML&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">YAML</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;message&#34;</span>: <span style="color:#d14">&#34;hey&#34;</span>, <span style="color:#d14">&#34;status&#34;</span>: http.StatusOK})
	})

	<span style="color:#998;font-style:italic">//Protocol buffers are a language-neutral, platform-neutral extensible mechanism for serializing structured data.
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">//Protocol buffers(简称ProtoBuf)是来自Google的一个跨语言,跨平台,用于将结构化数据序列化的可扩展机制,
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">//详见:https://developers.google.com/protocol-buffers
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someProtoBuf&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		reps <span style="color:#000;font-weight:bold">:=</span> []<span style="color:#458;font-weight:bold">int64</span>{<span style="color:#0086b3">int64</span>(<span style="color:#099">1</span>), <span style="color:#0086b3">int64</span>(<span style="color:#099">2</span>)}
		label <span style="color:#000;font-weight:bold">:=</span> <span style="color:#d14">&#34;test&#34;</span>
		<span style="color:#998;font-style:italic">// The specific definition of protobuf is written in the testdata/protoexample file.
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// 使用protoexample.Test这个特别的protobuf结构来定义测试数据
</span><span style="color:#998;font-style:italic"></span>		data <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">&amp;</span>protoexample.Test{
			Label: <span style="color:#000;font-weight:bold">&amp;</span>label,
			Reps:  reps,
		}
		<span style="color:#998;font-style:italic">// Note that data becomes binary data in the response  //将data序列化为二进制的响应数据
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// Will output protoexample.Test protobuf serialized data
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// ProtoBuf serializes the given struct as ProtoBuf into the response body.
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// ProtoBuf方法将给定的结构序列化为ProtoBuf响应体
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">ProtoBuf</span>(http.StatusOK, data)
	})

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}

<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟测试
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/someJSON
</span><span style="color:#998;font-style:italic">{&#34;message&#34;:&#34;hey&#34;,&#34;status&#34;:200}
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/moreJSON
</span><span style="color:#998;font-style:italic">{&#34;user&#34;:&#34;Lena&#34;,&#34;Message&#34;:&#34;hey&#34;,&#34;Number&#34;:123}
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/someXML
</span><span style="color:#998;font-style:italic">&lt;map&gt;&lt;message&gt;hey&lt;/message&gt;&lt;status&gt;200&lt;/status&gt;&lt;/map&gt;
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/someYAML
</span><span style="color:#998;font-style:italic">message: hey
</span><span style="color:#998;font-style:italic">status: 200
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/someProtoBuf
</span><span style="color:#998;font-style:italic">test
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="安全的json">安全的JSON</h4>
<p>使用SecureJSON方法保护Json不被劫持, 如果响应体是一个数组, 该方法会默认添加<code>while(1)</code>前缀到响应头,  这样的死循环可以防止后面的代码被恶意执行, 也可以自定义安全JSON的前缀.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	<span style="color:#998;font-style:italic">// You can also use your own secure json prefix
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// 你也可以自定义安全Json的前缀
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">SecureJsonPrefix</span>(<span style="color:#d14">&#34;)]}&#39;,\n&#34;</span>)

	<span style="color:#998;font-style:italic">//使用SecureJSON方法保护Json不被劫持, 如果响应体是一个数组, 该方法会默认添加`while(1)`前缀到响应头,  这样的死循环可以防止后面的代码被恶意执行, 也可以自定义安全JSON的前缀.
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someJSON&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		names <span style="color:#000;font-weight:bold">:=</span> []<span style="color:#458;font-weight:bold">string</span>{<span style="color:#d14">&#34;lena&#34;</span>, <span style="color:#d14">&#34;austin&#34;</span>, <span style="color:#d14">&#34;foo&#34;</span>}

		<span style="color:#998;font-style:italic">//names := map[string]string{
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">//	&#34;hello&#34;: &#34;world&#34;,
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">//}
</span><span style="color:#998;font-style:italic"></span>
		<span style="color:#998;font-style:italic">// Will output  :   while(1);[&#34;lena&#34;,&#34;austin&#34;,&#34;foo&#34;]
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">SecureJSON</span>(http.StatusOK, names)
	})

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}

<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟请求:curl http://localhost:8080/someJSON
</span><span style="color:#998;font-style:italic">)]}&#39;,
</span><span style="color:#998;font-style:italic">[&#34;lena&#34;,&#34;austin&#34;,&#34;foo&#34;]%
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="jsonp">JSONP</h4>
<p>使用JSONP可以实现跨域请求数据, 如果请求中有查询字符串参数callback, 则将返回数据作为参数传递给callback值(前端函数名),整体作为一个响应体,返回给前端.</p>
<p>JSONP是服务器与客户端跨源通信的常用方法. 最大特点就是简单适用, 老式浏览器全部支持, 服务器改造非常小, 它的基本思想是: 网页通过添加一个<!-- raw HTML omitted -->元素, 向服务器请求JSON数据, 这种做法不受同源政策限制, 服务器收到请求后, 将数据放在一个指定名字的回调函数里传回来, 这样, 前端可以完成一次前端函数的调用, 而参数是后端返回的数据.</p>
<p>注意: 这种方式存在被劫持的风险</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/JSONP&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		data <span style="color:#000;font-weight:bold">:=</span> gin.H{
			<span style="color:#d14">&#34;foo&#34;</span>: <span style="color:#d14">&#34;bar&#34;</span>,
		}

		<span style="color:#998;font-style:italic">//callback is x
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// Will output  :   x({\&#34;foo\&#34;:\&#34;bar\&#34;})
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// 使用JSONP可以实现跨域请求数据, 如果请求中有查询字符串参数callback, 则将返回数据作为参数传递给callback值(前端函数名),整体作为一个响应体,返回给前端
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">//JSONP是服务器与客户端跨源通信的常用方法。最大特点就是简单适用，老式浏览器全部支持，服务器改造非常小。
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">//它的基本思想是，网页通过添加一个&lt;script&gt;元素，向服务器请求JSON数据，这种做法不受同源政策限制；服务器收到请求后，将数据放在一个指定名字的回调函数里传回来
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">JSONP</span>(http.StatusOK, data)
	})

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)

	<span style="color:#998;font-style:italic">// 模拟客户端,请求参数中有callback参数,值为x(前端函数名),最后响应内容为x(&#34;foo&#34;:&#34;bar&#34;)
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// curl http://127.0.0.1:8080/JSONP?callback=x
</span><span style="color:#998;font-style:italic"></span>}
</code></pre></td></tr></table>
</div>
</div><h4 id="asciijson">AsciiJSON</h4>
<p>使用ASCII编码, 将非ASCII的字符进行转义和编码, 生成纯ASCII编码的JSON</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someJSON&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		data <span style="color:#000;font-weight:bold">:=</span> gin.H{
			<span style="color:#d14">&#34;lang&#34;</span>: <span style="color:#d14">&#34;GO语言&#34;</span>,
			<span style="color:#d14">&#34;tag&#34;</span>:  <span style="color:#d14">&#34;&lt;br&gt;&#34;</span>,
		}

		<span style="color:#998;font-style:italic">// 输出结果 : {&#34;lang&#34;:&#34;GO\u8bed\u8a00&#34;,&#34;tag&#34;:&#34;\u003cbr\u003e&#34;}
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// AsciiJSON方法返回带有Unicode编码和转义组成的纯ASCII字符串
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">AsciiJSON</span>(http.StatusOK, data)
	})

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}

<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟请求:curl http://localhost:8080/someJSON
</span><span style="color:#998;font-style:italic"> */</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="不带转义的原始json">不带转义的原始JSON</h4>
<p>通常, JSON会将特殊的HTML字符转化为他们的unicode编码, 如标签<code>&lt;</code>转为<code>\u003c</code> 使用PureJSON方法可以得到原始不做转义的字符串.</p>
<p>注意: 该方法至少需要Go版本1.6以上</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	<span style="color:#998;font-style:italic">// Serves unicode entities
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/json&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{
			<span style="color:#d14">&#34;html&#34;</span>: <span style="color:#d14">&#34;&lt;b&gt;Hello, world!&lt;/b&gt;&#34;</span>,
		})
	})

	<span style="color:#998;font-style:italic">// Serves literal characters
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/purejson&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">PureJSON</span>(<span style="color:#099">200</span>, gin.H{
			<span style="color:#d14">&#34;html&#34;</span>: <span style="color:#d14">&#34;&lt;b&gt;Hello, world!&lt;/b&gt;&#34;</span>,
		})
	})

	<span style="color:#998;font-style:italic">// listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟请求,得到将HTML标签转义后的JSON字符串
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/json
</span><span style="color:#998;font-style:italic">{&#34;html&#34;:&#34;\u003cb\u003eHello, world!\u003c/b\u003e&#34;}                                                                                                                                                                           
</span><span style="color:#998;font-style:italic">得到原始JSON字符串
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/purejson
</span><span style="color:#998;font-style:italic">{&#34;html&#34;:&#34;&lt;b&gt;Hello, world!&lt;/b&gt;&#34;}
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="静态文件服务">静态文件服务</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;log&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
	<span style="color:#d14">&#34;os&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	cwd, _ <span style="color:#000;font-weight:bold">:=</span> os.<span style="color:#900;font-weight:bold">Getwd</span>()  <span style="color:#998;font-style:italic">//获取当前文件目录
</span><span style="color:#998;font-style:italic"></span>	log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;当前项目路径:%s&#34;</span>, cwd)
	router.<span style="color:#900;font-weight:bold">Static</span>(<span style="color:#d14">&#34;/static&#34;</span>, cwd) <span style="color:#998;font-style:italic">//提供静态文件服务器, 第一个参数为相对路径,第二个参数为根路径, 这个路径一般放置css,js,fonts等静态文件,前端html中采用/static/js/xxx或/static/css/xxx等相对路径的方式引用
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">StaticFS</span>(<span style="color:#d14">&#34;/more_static&#34;</span>, http.<span style="color:#900;font-weight:bold">Dir</span>(<span style="color:#d14">&#34;./&#34;</span>)) <span style="color:#998;font-style:italic">//将本地文件树结构映射到前端, 通过浏览器可以访问本地文件系统, 模拟访问:http://localhost:8080/more_static
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">StaticFile</span>(<span style="color:#d14">&#34;/logo.png&#34;</span>, <span style="color:#d14">&#34;./resources/logo.png&#34;</span>)  <span style="color:#998;font-style:italic">//StaticFile提供单静态单文件服务, 模拟访问:http://localhost:8080/log.png
</span><span style="color:#998;font-style:italic"></span>
	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="返回文件数据">返回文件数据</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-contrib/cors&#34;</span>
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	router.<span style="color:#900;font-weight:bold">Use</span>(cors.<span style="color:#900;font-weight:bold">Default</span>())

	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/local/file&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">File</span>(<span style="color:#d14">&#34;./main.go&#34;</span>)
	})


	<span style="color:#998;font-style:italic">// A FileSystem implements access to a collection of named files.
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// The elements in a file path are separated by slash (&#39;/&#39;, U+002F)
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// characters, regardless of host operating system convention.
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// FileSystem接口, 要求实现文件的访问的方法, 提供文件访问服务根路径的HTTP处理器
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#000;font-weight:bold">var</span> fs http.FileSystem = http.<span style="color:#900;font-weight:bold">Dir</span>(<span style="color:#d14">&#34;./&#34;</span>)  <span style="color:#998;font-style:italic">//将本地目录作为文件服务根路径
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/fs/file&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">FileFromFS</span>(<span style="color:#d14">&#34;main.go&#34;</span>, fs)  <span style="color:#998;font-style:italic">//将文件服务系统下的文件数据返回
</span><span style="color:#998;font-style:italic"></span>	})
	router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟访问文件数据:
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/local/file
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">模拟访问文件系统下的文件数据:
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/fs/file
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="用文件读出器提供文件数据服务">用文件读出器提供文件数据服务</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/someDataFromReader&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		response, err <span style="color:#000;font-weight:bold">:=</span> http.<span style="color:#900;font-weight:bold">Get</span>(<span style="color:#d14">&#34;https://raw.githubusercontent.com/gin-gonic/logo/master/color.png&#34;</span>)
		<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">||</span> response.StatusCode <span style="color:#000;font-weight:bold">!=</span> http.StatusOK {  <span style="color:#998;font-style:italic">//请求链接中的文件出现错误时, 直接返回服务不可用
</span><span style="color:#998;font-style:italic"></span>			c.<span style="color:#900;font-weight:bold">Status</span>(http.StatusServiceUnavailable)
			<span style="color:#000;font-weight:bold">return</span>
		}

		reader <span style="color:#000;font-weight:bold">:=</span> response.Body  <span style="color:#998;font-style:italic">//用响应体内容构造一个文件读出器
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#000;font-weight:bold">defer</span> reader.<span style="color:#900;font-weight:bold">Close</span>()
		contentLength <span style="color:#000;font-weight:bold">:=</span> response.ContentLength
		contentType <span style="color:#000;font-weight:bold">:=</span> response.Header.<span style="color:#900;font-weight:bold">Get</span>(<span style="color:#d14">&#34;Content-Type&#34;</span>)

		extraHeaders <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">map</span>[<span style="color:#458;font-weight:bold">string</span>]<span style="color:#458;font-weight:bold">string</span>{
			<span style="color:#d14">&#34;Content-Disposition&#34;</span>: <span style="color:#d14">`attachment; filename=&#34;gopher.png&#34;`</span>,
		}
		<span style="color:#998;font-style:italic">// DataFromReader writes the specified reader into the body stream and updates the HTTP code.
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// func (c *Context) DataFromReader(code int, contentLength int64, contentType string, reader io.Reader, extraHeaders map[string]string) {}
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// DataFromReader方法将指定的读出器reader中的内容, 写入http响应体流中, 并更新响应码, 响应头信息等
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">DataFromReader</span>(http.StatusOK, contentLength, contentType, reader, extraHeaders)
	})
	router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟访问:
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/someDataFromReader
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="html渲染">HTML渲染</h3>
<p>使用LoadHTMLGlob()方法或LoadHTMLFiles()方法</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	<span style="color:#998;font-style:italic">//LoadHTMLGlob方法以glob模式加载匹配的HTML文件, 并与HTML渲染器结合
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">LoadHTMLGlob</span>(<span style="color:#d14">&#34;templates/*&#34;</span>)
	<span style="color:#998;font-style:italic">//router.LoadHTMLFiles(&#34;templates/template1.html&#34;, &#34;templates/template2.html&#34;)
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/index&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		<span style="color:#998;font-style:italic">//HTML方法设置响应码, 模板文件名, 渲染替换模板中的值, 设置响应内容类型Content-Type &#34;text/html&#34;
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">HTML</span>(http.StatusOK, <span style="color:#d14">&#34;index.tmpl&#34;</span>, gin.H{
			<span style="color:#d14">&#34;title&#34;</span>: <span style="color:#d14">&#34;Main website&#34;</span>,
		})
	})
	router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟测试:
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/index
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><p>增加模板文件, templates/index.tmpl</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#000080">html</span>&gt;
	&lt;<span style="color:#000080">h1</span>&gt;
		{{ .title }}
	&lt;/<span style="color:#000080">h1</span>&gt;
&lt;/<span style="color:#000080">html</span>&gt;
</code></pre></td></tr></table>
</div>
</div><p>使用不同文件夹下的相同文件名的模板文件</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	router.<span style="color:#900;font-weight:bold">LoadHTMLGlob</span>(<span style="color:#d14">&#34;templates/**/*&#34;</span>)
	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/posts/index&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">HTML</span>(http.StatusOK, <span style="color:#d14">&#34;posts/index.tmpl&#34;</span>, gin.H{
			<span style="color:#d14">&#34;title&#34;</span>: <span style="color:#d14">&#34;Posts&#34;</span>,
		})
	})
	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/users/index&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">HTML</span>(http.StatusOK, <span style="color:#d14">&#34;users/index.tmpl&#34;</span>, gin.H{
			<span style="color:#d14">&#34;title&#34;</span>: <span style="color:#d14">&#34;Users&#34;</span>,
		})
	})
	router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><p>posts目录下添加模板文件, templates/posts/index.tmpl</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">{{ define &#34;posts/index.tmpl&#34; }}
&lt;<span style="color:#000080">html</span>&gt;&lt;<span style="color:#000080">h1</span>&gt;
	{{ .title }}
&lt;/<span style="color:#000080">h1</span>&gt;
&lt;<span style="color:#000080">p</span>&gt;Using posts/index.tmpl&lt;/<span style="color:#000080">p</span>&gt;
&lt;/<span style="color:#000080">html</span>&gt;
{{ end }}
</code></pre></td></tr></table>
</div>
</div><p>users目录下添加模板文件, templates/users/index.tmpl</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">{{ define &#34;users/index.tmpl&#34; }}
&lt;<span style="color:#000080">html</span>&gt;&lt;<span style="color:#000080">h1</span>&gt;
	{{ .title }}
&lt;/<span style="color:#000080">h1</span>&gt;
&lt;<span style="color:#000080">p</span>&gt;Using users/index.tmpl&lt;/<span style="color:#000080">p</span>&gt;
&lt;/<span style="color:#000080">html</span>&gt;
{{ end }}
</code></pre></td></tr></table>
</div>
</div><h4 id="自定义模板渲染器">自定义模板渲染器</h4>
<p>你也可以使用你自定义的HTML模板渲染器, 需要自定义模板文件file1, file2等</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;html/template&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	<span style="color:#998;font-style:italic">//template.ParseFiles(文件1,文件2...)创建一个模板对象, 然后解析一组模板，使用文件名作为模板的名字
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// Must方法将模板和错误进行包裹, 返回模板的内存地址 一般用于变量初始化,比如:var t = template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))
</span><span style="color:#998;font-style:italic"></span>	html <span style="color:#000;font-weight:bold">:=</span> template.<span style="color:#900;font-weight:bold">Must</span>(template.<span style="color:#900;font-weight:bold">ParseFiles</span>(<span style="color:#d14">&#34;file1&#34;</span>, <span style="color:#d14">&#34;file2&#34;</span>))
	router.<span style="color:#900;font-weight:bold">SetHTMLTemplate</span>(html) <span style="color:#998;font-style:italic">//关联模板和HTML渲染器
</span><span style="color:#998;font-style:italic"></span>
	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/index&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		<span style="color:#998;font-style:italic">//HTML方法设置响应码, 模板文件名, 渲染替换模板中的值, 设置响应内容类型Content-Type &#34;text/html&#34;
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">HTML</span>(http.StatusOK, <span style="color:#d14">&#34;file1&#34;</span>, gin.H{
			<span style="color:#d14">&#34;title&#34;</span>: <span style="color:#d14">&#34;Main website&#34;</span>,
		})
	})
	router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h4 id="自定义分隔符">自定义分隔符</h4>
<p>你可以自定义分隔符, 模板中默认的分隔符是{{  }}, 我们也可以修改, 比如下面增加一对中括号</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	r.<span style="color:#900;font-weight:bold">Delims</span>(<span style="color:#d14">&#34;{[{&#34;</span>, <span style="color:#d14">&#34;}]}&#34;</span>)
	r.<span style="color:#900;font-weight:bold">LoadHTMLGlob</span>(<span style="color:#d14">&#34;/path/to/templates&#34;</span>)
</code></pre></td></tr></table>
</div>
</div><h4 id="自定义模板方法">自定义模板方法</h4>
<p>详见 <a href="https://github.com/gin-gonic/examples/tree/master/template">示例代码</a>.</p>
<p>模板中与后端都定义好模板方法, 模板渲染时执行该方法, 类似过滤器方法, 比如时间格式化操作</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;fmt&#34;</span>
	<span style="color:#d14">&#34;html/template&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
	<span style="color:#d14">&#34;time&#34;</span>

	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">formatAsDate</span>(t time.Time) <span style="color:#458;font-weight:bold">string</span> {
	year, month, day <span style="color:#000;font-weight:bold">:=</span> t.<span style="color:#900;font-weight:bold">Date</span>()  <span style="color:#998;font-style:italic">//Date方法返回年,月,日
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#000;font-weight:bold">return</span> fmt.<span style="color:#900;font-weight:bold">Sprintf</span>(<span style="color:#d14">&#34;%d%02d/%02d&#34;</span>, year, month, day)  <span style="color:#998;font-style:italic">//格式化时间
</span><span style="color:#998;font-style:italic"></span>}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	router.<span style="color:#900;font-weight:bold">Delims</span>(<span style="color:#d14">&#34;{[{&#34;</span>, <span style="color:#d14">&#34;}]}&#34;</span>) <span style="color:#998;font-style:italic">//自定义模板中的左右分隔符
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">//SetFuncMap方法用给定的template.FuncMap设置到Gin引擎上, 后面模板渲染时会调用同名方法
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">//FuncMap是一个map,键名关联方法名, 键值关联方法, 每个方法必须返回一个值, 或者返回两个值,其中第二个是error类型
</span><span style="color:#998;font-style:italic"></span>	router.<span style="color:#900;font-weight:bold">SetFuncMap</span>(template.FuncMap{
		<span style="color:#d14">&#34;formatAsDate&#34;</span>: formatAsDate,
	})
	router.<span style="color:#900;font-weight:bold">LoadHTMLFiles</span>(<span style="color:#d14">&#34;./testdata/template/raw.tmpl&#34;</span>) <span style="color:#998;font-style:italic">//加载单个模板文件并与HTML渲染器关联
</span><span style="color:#998;font-style:italic"></span>
	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/raw&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">HTML</span>(http.StatusOK, <span style="color:#d14">&#34;raw.tmpl&#34;</span>, gin.H{
			<span style="color:#d14">&#34;now&#34;</span>: time.<span style="color:#900;font-weight:bold">Date</span>(<span style="color:#099">2017</span>, <span style="color:#099">07</span>, <span style="color:#099">01</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, <span style="color:#099">0</span>, time.UTC),
		})
	})

	router.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}

<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟测试:
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/raw
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><p>定义模板文件: raw.tmpl</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">Date: {[{.now | formatAsDate}]}
</code></pre></td></tr></table>
</div>
</div><p>时间格式化结果:</p>
<pre><code>Date: 2017/07/01
</code></pre><h3 id="多个模板">多个模板</h3>
<p>Gin默认只使用一个html.Template模板引擎, 也可以参考<a href="https://github.com/gin-contrib/multitemplate">多模板渲染器</a>使用类似Go1.6的块级模板<code>block template</code>功能.</p>
<p>模板相关详情请参考官方<a href="https://golang.org/pkg/text/template/">template包</a></p>
<h3 id="重定向">重定向</h3>
<p>Gin返回一个HTTP重定向非常简单, 使用Redirect方法即可. 内部和外部链接都支持.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/test&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">Redirect</span>(http.StatusMovedPermanently, <span style="color:#d14">&#34;http://www.google.com/&#34;</span>)  <span style="color:#998;font-style:italic">//重定向到外部链接
</span><span style="color:#998;font-style:italic"></span>	})

	<span style="color:#998;font-style:italic">//重定向到内部链接
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/internal&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">Redirect</span>(http.StatusMovedPermanently, <span style="color:#d14">&#34;/home&#34;</span>)
	})

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/home&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{<span style="color:#d14">&#34;msg&#34;</span>: <span style="color:#d14">&#34;这是首页&#34;</span>})
	})
	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}

<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">重定向到外部链接,访问:http://localhost:8080/test
</span><span style="color:#998;font-style:italic">重定向到内部链接,访问:http://localhost:8080/internal
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><p>从POST方法中完成HTTP重定向, 参考问题<a href="https://github.com/gin-gonic/gin/issues/444">#444</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">r.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/test&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
	c.<span style="color:#900;font-weight:bold">Redirect</span>(http.StatusFound, <span style="color:#d14">&#34;/foo&#34;</span>)
})
</code></pre></td></tr></table>
</div>
</div><p>如果要产生一个路由重定向, 类似上面的内部重定向, 则使用 <code>HandleContext</code>方法, 像下面这样使用:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/test&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    c.Request.URL.Path = <span style="color:#d14">&#34;/test2&#34;</span>
    r.<span style="color:#900;font-weight:bold">HandleContext</span>(c)
})
r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/test2&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{<span style="color:#d14">&#34;hello&#34;</span>: <span style="color:#d14">&#34;world&#34;</span>})
})
</code></pre></td></tr></table>
</div>
</div><h3 id="自定义中间件">自定义中间件</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;log&#34;</span>
	<span style="color:#d14">&#34;time&#34;</span>
)

<span style="color:#998;font-style:italic">//自定义日志中间件
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">Logger</span>() gin.HandlerFunc {
	<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		t <span style="color:#000;font-weight:bold">:=</span> time.<span style="color:#900;font-weight:bold">Now</span>()

		<span style="color:#998;font-style:italic">// Set example variable 在gin上下文中设置键值对
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">Set</span>(<span style="color:#d14">&#34;example&#34;</span>, <span style="color:#d14">&#34;12345&#34;</span>)

		<span style="color:#998;font-style:italic">// before request
</span><span style="color:#998;font-style:italic"></span>
		<span style="color:#998;font-style:italic">//Next方法只能用于中间件中,在当前中间件中, 从方法链执行挂起的处理器
</span><span style="color:#998;font-style:italic"></span>		c.<span style="color:#900;font-weight:bold">Next</span>()

		<span style="color:#998;font-style:italic">// after request  打印中间件执行耗时
</span><span style="color:#998;font-style:italic"></span>		latency <span style="color:#000;font-weight:bold">:=</span> time.<span style="color:#900;font-weight:bold">Since</span>(t)
		log.<span style="color:#900;font-weight:bold">Print</span>(latency)

		<span style="color:#998;font-style:italic">// access the status we are sending  打印本中间件的状态码
</span><span style="color:#998;font-style:italic"></span>		status <span style="color:#000;font-weight:bold">:=</span> c.Writer.<span style="color:#900;font-weight:bold">Status</span>()
		log.<span style="color:#900;font-weight:bold">Println</span>(status)
	}
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()
  <span style="color:#998;font-style:italic">//使用该自定义中间件
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Use</span>(<span style="color:#900;font-weight:bold">Logger</span>())
	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/test&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		example <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">MustGet</span>(<span style="color:#d14">&#34;example&#34;</span>).(<span style="color:#458;font-weight:bold">string</span>) <span style="color:#998;font-style:italic">//从上下文中获取键值对
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// it would print: &#34;12345&#34;
</span><span style="color:#998;font-style:italic"></span>		log.<span style="color:#900;font-weight:bold">Println</span>(example)
	})

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="使用基本认证basicauth中间件">使用基本认证BasicAuth()中间件</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
)

<span style="color:#998;font-style:italic">// simulate some private data
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">var</span> secrets = gin.H{
	<span style="color:#d14">&#34;foo&#34;</span>:    gin.H{<span style="color:#d14">&#34;email&#34;</span>: <span style="color:#d14">&#34;foo@bar.com&#34;</span>, <span style="color:#d14">&#34;phone&#34;</span>: <span style="color:#d14">&#34;123433&#34;</span>},
	<span style="color:#d14">&#34;austin&#34;</span>: gin.H{<span style="color:#d14">&#34;email&#34;</span>: <span style="color:#d14">&#34;austin@example.com&#34;</span>, <span style="color:#d14">&#34;phone&#34;</span>: <span style="color:#d14">&#34;666&#34;</span>},
	<span style="color:#d14">&#34;lena&#34;</span>:   gin.H{<span style="color:#d14">&#34;email&#34;</span>: <span style="color:#d14">&#34;lena@guapa.com&#34;</span>, <span style="color:#d14">&#34;phone&#34;</span>: <span style="color:#d14">&#34;523443&#34;</span>},
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	<span style="color:#998;font-style:italic">// Group using gin.BasicAuth() middleware
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// gin.Accounts is a shortcut for map[string]string
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// 路由组authorized使用基本认证中间件, 参数为gin.Accounts,是一个map,键名是用户名, 键值是密码, 该中间件会将认证信息保存到cookie中
</span><span style="color:#998;font-style:italic"></span>	authorized <span style="color:#000;font-weight:bold">:=</span> r.<span style="color:#900;font-weight:bold">Group</span>(<span style="color:#d14">&#34;/admin&#34;</span>, gin.<span style="color:#900;font-weight:bold">BasicAuth</span>(gin.Accounts{
		<span style="color:#d14">&#34;foo&#34;</span>:    <span style="color:#d14">&#34;bar&#34;</span>,
		<span style="color:#d14">&#34;austin&#34;</span>: <span style="color:#d14">&#34;1234&#34;</span>,
		<span style="color:#d14">&#34;lena&#34;</span>:   <span style="color:#d14">&#34;hello2&#34;</span>,
		<span style="color:#d14">&#34;manu&#34;</span>:   <span style="color:#d14">&#34;4321&#34;</span>,
	}))

	<span style="color:#998;font-style:italic">// /admin/secrets endpoint
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// hit &#34;localhost:8080/admin/secrets
</span><span style="color:#998;font-style:italic"></span>	authorized.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/secrets&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		<span style="color:#998;font-style:italic">// get user, it was set by the BasicAuth middleware
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// 从cookie中获取用户认证信息, 键名为user
</span><span style="color:#998;font-style:italic"></span>		user <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">MustGet</span>(gin.AuthUserKey).(<span style="color:#458;font-weight:bold">string</span>)
		<span style="color:#000;font-weight:bold">if</span> secret, ok <span style="color:#000;font-weight:bold">:=</span> secrets[user]; ok {
			c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;user&#34;</span>: user, <span style="color:#d14">&#34;secret&#34;</span>: secret})
		} <span style="color:#000;font-weight:bold">else</span> {
			c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, gin.H{<span style="color:#d14">&#34;user&#34;</span>: user, <span style="color:#d14">&#34;secret&#34;</span>: <span style="color:#d14">&#34;NO SECRET :(&#34;</span>})
		}
	})

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">测试访问:http://localhost:8080/admin/secrets
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="在中间件中使用协程goroutines">在中间件中使用协程Goroutines</h3>
<p>在中间件或者控制器中启动新协程时, 不能直接使用原来的Gin上下文, 必须使用一个只读的上下文副本</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;log&#34;</span>
	<span style="color:#d14">&#34;time&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/long_async&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		<span style="color:#998;font-style:italic">// create copy to be used inside the goroutine
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// 创建一个Gin上下文的副本, 准备在协程Goroutine中使用
</span><span style="color:#998;font-style:italic"></span>		cCp <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">Copy</span>()
		<span style="color:#000;font-weight:bold">go</span> <span style="color:#000;font-weight:bold">func</span>() {
			<span style="color:#998;font-style:italic">// simulate a long task with time.Sleep(). 5 seconds
</span><span style="color:#998;font-style:italic"></span>			<span style="color:#998;font-style:italic">// 模拟长时间任务,这里是5秒
</span><span style="color:#998;font-style:italic"></span>			time.<span style="color:#900;font-weight:bold">Sleep</span>(<span style="color:#099">5</span> <span style="color:#000;font-weight:bold">*</span> time.Second)

			<span style="color:#998;font-style:italic">// note that you are using the copied context &#34;cCp&#34;, IMPORTANT
</span><span style="color:#998;font-style:italic"></span>			<span style="color:#998;font-style:italic">// 在中间件或者控制器中启动协程时, 不能直接使用原来的上下文, 必须使用一个只读的上线文副本
</span><span style="color:#998;font-style:italic"></span>			log.<span style="color:#900;font-weight:bold">Println</span>(<span style="color:#d14">&#34;Done! in path &#34;</span> <span style="color:#000;font-weight:bold">+</span> cCp.Request.URL.Path)
		}()
	})

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/long_sync&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		<span style="color:#998;font-style:italic">// simulate a long task with time.Sleep(). 5 seconds
</span><span style="color:#998;font-style:italic"></span>		time.<span style="color:#900;font-weight:bold">Sleep</span>(<span style="color:#099">5</span> <span style="color:#000;font-weight:bold">*</span> time.Second)

		<span style="color:#998;font-style:italic">// since we are NOT using a goroutine, we do not have to copy the context
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#998;font-style:italic">// 没有使用协程时, 可以直接使用Gin上下文
</span><span style="color:#998;font-style:italic"></span>		log.<span style="color:#900;font-weight:bold">Println</span>(<span style="color:#d14">&#34;Done! in path &#34;</span> <span style="color:#000;font-weight:bold">+</span> c.Request.URL.Path)
	})

	<span style="color:#998;font-style:italic">// Listen and serve on 0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟同步阻塞访问:http://localhost:8080/long_sync
</span><span style="color:#998;font-style:italic">模拟异步非阻塞访问:http://localhost:8080/long_async
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="自定义http配置">自定义HTTP配置</h3>
<p>直接使用 <code>http.ListenAndServe()</code>方法:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	http.<span style="color:#900;font-weight:bold">ListenAndServe</span>(<span style="color:#d14">&#34;:8080&#34;</span>, router)
}
</code></pre></td></tr></table>
</div>
</div><p>或者自定义HTTP配置</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	s <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">&amp;</span>http.Server{
		Addr:           <span style="color:#d14">&#34;:8080&#34;</span>,
		Handler:        router,
		ReadTimeout:    <span style="color:#099">10</span> <span style="color:#000;font-weight:bold">*</span> time.Second,
		WriteTimeout:   <span style="color:#099">10</span> <span style="color:#000;font-weight:bold">*</span> time.Second,
		MaxHeaderBytes: <span style="color:#099">1</span> <span style="color:#000;font-weight:bold">&lt;&lt;</span> <span style="color:#099">20</span>,
	}
	s.<span style="color:#900;font-weight:bold">ListenAndServe</span>()
}
</code></pre></td></tr></table>
</div>
</div><h3 id="支持letsencrypt证书加密处理https">支持Let&rsquo;sEncrypt证书加密处理HTTPS</h3>
<p>下面是一行式的LetsEncrypt HTTPS服务</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;log&#34;</span>

	<span style="color:#d14">&#34;github.com/gin-gonic/autotls&#34;</span>
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	<span style="color:#998;font-style:italic">// Ping handler
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;pong&#34;</span>)
	})
	<span style="color:#998;font-style:italic">//一行式LetsEncrypt证书, 处理https
</span><span style="color:#998;font-style:italic"></span>	log.<span style="color:#900;font-weight:bold">Fatal</span>(autotls.<span style="color:#900;font-weight:bold">Run</span>(r, <span style="color:#d14">&#34;example1.com&#34;</span>, <span style="color:#d14">&#34;example2.com&#34;</span>))
}
</code></pre></td></tr></table>
</div>
</div><p>自定义自动证书管理器autocert manager实例代码:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;log&#34;</span>

	<span style="color:#d14">&#34;github.com/gin-gonic/autotls&#34;</span>
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;golang.org/x/crypto/acme/autocert&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

	<span style="color:#998;font-style:italic">// Ping handler
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;pong&#34;</span>)
	})

	m <span style="color:#000;font-weight:bold">:=</span> autocert.Manager{
		Prompt:     autocert.AcceptTOS, <span style="color:#998;font-style:italic">//Prompt指定一个回调函数有条件的接受证书机构CA的TOS服务, 使用AcceptTOS总是接受服务条款
</span><span style="color:#998;font-style:italic"></span>		HostPolicy: autocert.<span style="color:#900;font-weight:bold">HostWhitelist</span>(<span style="color:#d14">&#34;example1.com&#34;</span>, <span style="color:#d14">&#34;example2.com&#34;</span>),  <span style="color:#998;font-style:italic">//HostPolicy用于控制指定哪些域名, 管理器将检索新证书
</span><span style="color:#998;font-style:italic"></span>		Cache:      autocert.<span style="color:#900;font-weight:bold">DirCache</span>(<span style="color:#d14">&#34;/var/www/.cache&#34;</span>),  <span style="color:#998;font-style:italic">//缓存证书和其他状态
</span><span style="color:#998;font-style:italic"></span>	}

	log.<span style="color:#900;font-weight:bold">Fatal</span>(autotls.<span style="color:#900;font-weight:bold">RunWithManager</span>(r, <span style="color:#000;font-weight:bold">&amp;</span>m))
}
</code></pre></td></tr></table>
</div>
</div><p>详情参考<a href="https://github.com/gin-gonic/autotls">autotls包</a></p>
<h3 id="使用gin运行多个服务">使用Gin运行多个服务</h3>
<p>可以在主函数中使用协程Goroutine运行多个服务, 每个服务端口不同, 路由分组也不同. 请参考这个<a href="https://github.com/gin-gonic/gin/issues/346">问题</a>,  尝试运行以下示例代码:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;log&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
	<span style="color:#d14">&#34;time&#34;</span>

	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;golang.org/x/sync/errgroup&#34;</span>
)

<span style="color:#000;font-weight:bold">var</span> (
	g errgroup.Group
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">router01</span>() http.Handler {
	e <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()
	e.<span style="color:#900;font-weight:bold">Use</span>(gin.<span style="color:#900;font-weight:bold">Recovery</span>())
	e.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(
			http.StatusOK,
			gin.H{
				<span style="color:#d14">&#34;code&#34;</span>:  http.StatusOK,
				<span style="color:#d14">&#34;error&#34;</span>: <span style="color:#d14">&#34;Welcome server 01&#34;</span>,
			},
		)
	})

	<span style="color:#000;font-weight:bold">return</span> e
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">router02</span>() http.Handler {
	e <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()
	e.<span style="color:#900;font-weight:bold">Use</span>(gin.<span style="color:#900;font-weight:bold">Recovery</span>())
	e.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(
			http.StatusOK,
			gin.H{
				<span style="color:#d14">&#34;code&#34;</span>:  http.StatusOK,
				<span style="color:#d14">&#34;error&#34;</span>: <span style="color:#d14">&#34;Welcome server 02&#34;</span>,
			},
		)
	})

	<span style="color:#000;font-weight:bold">return</span> e
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	server01 <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">&amp;</span>http.Server{
		Addr:         <span style="color:#d14">&#34;:8080&#34;</span>,
		Handler:      <span style="color:#900;font-weight:bold">router01</span>(),
		ReadTimeout:  <span style="color:#099">5</span> <span style="color:#000;font-weight:bold">*</span> time.Second,
		WriteTimeout: <span style="color:#099">10</span> <span style="color:#000;font-weight:bold">*</span> time.Second,
	}

	server02 <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">&amp;</span>http.Server{
		Addr:         <span style="color:#d14">&#34;:8081&#34;</span>,
		Handler:      <span style="color:#900;font-weight:bold">router02</span>(),
		ReadTimeout:  <span style="color:#099">5</span> <span style="color:#000;font-weight:bold">*</span> time.Second,
		WriteTimeout: <span style="color:#099">10</span> <span style="color:#000;font-weight:bold">*</span> time.Second,
	}

	g.<span style="color:#900;font-weight:bold">Go</span>(<span style="color:#000;font-weight:bold">func</span>() <span style="color:#458;font-weight:bold">error</span> {
		err <span style="color:#000;font-weight:bold">:=</span> server01.<span style="color:#900;font-weight:bold">ListenAndServe</span>()
		<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> err <span style="color:#000;font-weight:bold">!=</span> http.ErrServerClosed {
			log.<span style="color:#900;font-weight:bold">Fatal</span>(err)
		}
		<span style="color:#000;font-weight:bold">return</span> err
	})

	g.<span style="color:#900;font-weight:bold">Go</span>(<span style="color:#000;font-weight:bold">func</span>() <span style="color:#458;font-weight:bold">error</span> {
		err <span style="color:#000;font-weight:bold">:=</span> server02.<span style="color:#900;font-weight:bold">ListenAndServe</span>()
		<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> err <span style="color:#000;font-weight:bold">!=</span> http.ErrServerClosed {
			log.<span style="color:#900;font-weight:bold">Fatal</span>(err)
		}
		<span style="color:#000;font-weight:bold">return</span> err
	})

	<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> g.<span style="color:#900;font-weight:bold">Wait</span>(); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
		log.<span style="color:#900;font-weight:bold">Fatal</span>(err)
	}
}

<span style="color:#998;font-style:italic">/*
</span><span style="color:#998;font-style:italic">模拟访问服务1:
</span><span style="color:#998;font-style:italic">curl http://localhost:8080/
</span><span style="color:#998;font-style:italic">{&#34;code&#34;:200,&#34;error&#34;:&#34;Welcome server 01&#34;}
</span><span style="color:#998;font-style:italic">
</span><span style="color:#998;font-style:italic">模拟访问服务2:
</span><span style="color:#998;font-style:italic">curl http://localhost:8081/
</span><span style="color:#998;font-style:italic">{&#34;code&#34;:200,&#34;error&#34;:&#34;Welcome server 02&#34;}
</span><span style="color:#998;font-style:italic">*/</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="优雅的关闭和重启服务">优雅的关闭和重启服务</h3>
<p>有一些方法可以优雅的关闭或者重启服务, 比如不应该中断活动的连接, 需要优雅等待服务完成后才执行关闭或重启. 你可以使用第三方包来实现, 也可以使用内置的包自己实现优雅关闭或重启.</p>
<h4 id="使用第三方包">使用第三方包</h4>
<p><a href="https://github.com/fvbock/endless">fvbock/endless</a> 包, 可以实现Golang HTTP/HTTPS服务的零停机和优雅重启(Golang版本至少1.3以上)</p>
<p>我们可以使用<a href="https://github.com/fvbock/endless">fvbock/endless</a> 替代默认的 <code>ListenAndServe</code>方法, 更多详情, 请参考问题<a href="https://github.com/gin-gonic/gin/issues/296">#296</a>.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, handler)
<span style="color:#998;font-style:italic">// [...]
</span><span style="color:#998;font-style:italic"></span>endless.<span style="color:#900;font-weight:bold">ListenAndServe</span>(<span style="color:#d14">&#34;:4242&#34;</span>, router)
</code></pre></td></tr></table>
</div>
</div><p>其他替代包:</p>
<ul>
<li><a href="https://github.com/braintree/manners">manners</a>: 一个优雅的Go HTTP服务, 可以优雅的关闭服务.</li>
<li><a href="https://github.com/tylerb/graceful">graceful</a>: 优雅的Go包, 能够优雅的关闭一个http.Handler服务</li>
<li><a href="https://github.com/facebookgo/grace">grace</a>: 该包为Go服务实现优雅重启, 零停机</li>
</ul>
<h4 id="手动实现">手动实现</h4>
<p>如果你使用Go1.8或者更高的版本, 你可能不需要使用这些库. 可以考虑使用http.Server的内置方法<a href="https://golang.org/pkg/net/http/#Server.Shutdown">Shutdown()</a>来优雅关闭服务. 下面的示例描述了基本用法, 更多示例请参考<a href="https://github.com/gin-gonic/examples/tree/master/graceful-shutdown">这里</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#998;font-style:italic">// +build go1.8
</span><span style="color:#998;font-style:italic"></span>
<span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;context&#34;</span>
	<span style="color:#d14">&#34;log&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
	<span style="color:#d14">&#34;os&#34;</span>
	<span style="color:#d14">&#34;os/signal&#34;</span>
	<span style="color:#d14">&#34;syscall&#34;</span>
	<span style="color:#d14">&#34;time&#34;</span>

	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		time.<span style="color:#900;font-weight:bold">Sleep</span>(<span style="color:#099">5</span> <span style="color:#000;font-weight:bold">*</span> time.Second)
		c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">&#34;Welcome Gin Server&#34;</span>)
	})

	srv <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">&amp;</span>http.Server{
		Addr:    <span style="color:#d14">&#34;:8080&#34;</span>,
		Handler: router,
	}

	<span style="color:#998;font-style:italic">// Initializing the server in a goroutine so that
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// it won&#39;t block the graceful shutdown handling below
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// 用协程初始化一个服务, 它不会阻塞下面的优雅逻辑处理
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#000;font-weight:bold">go</span> <span style="color:#000;font-weight:bold">func</span>() {
		<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> srv.<span style="color:#900;font-weight:bold">ListenAndServe</span>(); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> err <span style="color:#000;font-weight:bold">!=</span> http.ErrServerClosed {
			log.<span style="color:#900;font-weight:bold">Fatalf</span>(<span style="color:#d14">&#34;listen: %s\n&#34;</span>, err)
		}
	}()

	<span style="color:#998;font-style:italic">// Wait for interrupt signal to gracefully shutdown the server with
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// a timeout of 5 seconds.
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">//等待一个操作系统的中断信号, 来优雅的关闭服务
</span><span style="color:#998;font-style:italic"></span>	quit <span style="color:#000;font-weight:bold">:=</span> <span style="color:#0086b3">make</span>(<span style="color:#000;font-weight:bold">chan</span> os.Signal)
	<span style="color:#998;font-style:italic">// kill (no param) default send syscall.SIGTERM  //kill会发送终止信号
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// kill -2 is syscall.SIGINT  //发送强制进程结束信号
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// kill -9 is syscall.SIGKILL but can&#39;t be catch, so don&#39;t need add it  //发送SIGKILL信号给进程
</span><span style="color:#998;font-style:italic"></span>	signal.<span style="color:#900;font-weight:bold">Notify</span>(quit, syscall.SIGINT, syscall.SIGTERM)
	<span style="color:#000;font-weight:bold">&lt;-</span>quit <span style="color:#998;font-style:italic">//阻塞在这里,直到获取到一个上面的信号
</span><span style="color:#998;font-style:italic"></span>	log.<span style="color:#900;font-weight:bold">Println</span>(<span style="color:#d14">&#34;Shutting down server...&#34;</span>)

	<span style="color:#998;font-style:italic">// The context is used to inform the server it has 5 seconds to finish
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">// the request it is currently handling
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#998;font-style:italic">//这里使用context上下文包, 有5秒钟的处理超时时间
</span><span style="color:#998;font-style:italic"></span>	ctx, cancel <span style="color:#000;font-weight:bold">:=</span> context.<span style="color:#900;font-weight:bold">WithTimeout</span>(context.<span style="color:#900;font-weight:bold">Background</span>(), <span style="color:#099">5</span><span style="color:#000;font-weight:bold">*</span>time.Second)
	<span style="color:#000;font-weight:bold">defer</span> <span style="color:#900;font-weight:bold">cancel</span>()
	<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> srv.<span style="color:#900;font-weight:bold">Shutdown</span>(ctx); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {  <span style="color:#998;font-style:italic">//利用内置Shutdown方法优雅关闭服务
</span><span style="color:#998;font-style:italic"></span>		log.<span style="color:#900;font-weight:bold">Fatal</span>(<span style="color:#d14">&#34;Server forced to shutdown:&#34;</span>, err)
	}

	log.<span style="color:#900;font-weight:bold">Println</span>(<span style="color:#d14">&#34;Server exiting&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="将模板文件一起编译为一个二进制单文件">将模板文件一起编译为一个二进制单文件</h3>
<p>使用<a href="https://github.com/jessevdk/go-assets">go-assets</a>, 你可以将模板文件和服务一起编译为一个二进制的单文件, 可以方便快捷的部署该服务. 请参考go资产编译器<a href="https://github.com/jessevdk/go-assets-builder">go-assets-builder</a></p>
<p>使用方法:</p>
<pre><code>1.下载依赖包
go get github.com/gin-gonic/gin
go get github.com/jessevdk/go-assets-builder

2.将html文件夹(包含html代码)生成为go资产文件assets.go
go-assets-builder html -o assets.go

3.编译构建,将服务打包为单二进制文件
go build -o assets-in-binary

4.运行服务
./assets-in-binary
</code></pre><p>go资产文件go-assets.go参考内容如下:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;time&#34;</span>

	<span style="color:#d14">&#34;github.com/jessevdk/go-assets&#34;</span>
)

<span style="color:#000;font-weight:bold">var</span> _Assetsbfa8d115ce0617d89507412d5393a462f8e9b003 = <span style="color:#d14">&#34;&lt;!doctype html&gt;\n&lt;body&gt;\n  &lt;p&gt;Can you see this? → {{.Bar}}&lt;/p&gt;\n&lt;/body&gt;\n&#34;</span>
<span style="color:#000;font-weight:bold">var</span> _Assets3737a75b5254ed1f6d588b40a3449721f9ea86c2 = <span style="color:#d14">&#34;&lt;!doctype html&gt;\n&lt;body&gt;\n  &lt;p&gt;Hello, {{.Foo}}&lt;/p&gt;\n&lt;/body&gt;\n&#34;</span>

<span style="color:#998;font-style:italic">// Assets returns go-assets FileSystem
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">var</span> Assets = assets.<span style="color:#900;font-weight:bold">NewFileSystem</span>(<span style="color:#000;font-weight:bold">map</span>[<span style="color:#458;font-weight:bold">string</span>][]<span style="color:#458;font-weight:bold">string</span>{<span style="color:#d14">&#34;/&#34;</span>: {<span style="color:#d14">&#34;html&#34;</span>}, <span style="color:#d14">&#34;/html&#34;</span>: {<span style="color:#d14">&#34;bar.tmpl&#34;</span>, <span style="color:#d14">&#34;index.tmpl&#34;</span>}}, <span style="color:#000;font-weight:bold">map</span>[<span style="color:#458;font-weight:bold">string</span>]<span style="color:#000;font-weight:bold">*</span>assets.File{
	<span style="color:#d14">&#34;/&#34;</span>: {
		Path:     <span style="color:#d14">&#34;/&#34;</span>,
		FileMode: <span style="color:#099">0x800001ed</span>,
		Mtime:    time.<span style="color:#900;font-weight:bold">Unix</span>(<span style="color:#099">1524365738</span>, <span style="color:#099">1524365738517125470</span>),
		Data:     <span style="color:#000;font-weight:bold">nil</span>,
	}, <span style="color:#d14">&#34;/html&#34;</span>: {
		Path:     <span style="color:#d14">&#34;/html&#34;</span>,
		FileMode: <span style="color:#099">0x800001ed</span>,
		Mtime:    time.<span style="color:#900;font-weight:bold">Unix</span>(<span style="color:#099">1524365491</span>, <span style="color:#099">1524365491289799093</span>),
		Data:     <span style="color:#000;font-weight:bold">nil</span>,
	}, <span style="color:#d14">&#34;/html/bar.tmpl&#34;</span>: {
		Path:     <span style="color:#d14">&#34;/html/bar.tmpl&#34;</span>,
		FileMode: <span style="color:#099">0x1a4</span>,
		Mtime:    time.<span style="color:#900;font-weight:bold">Unix</span>(<span style="color:#099">1524365491</span>, <span style="color:#099">1524365491289611557</span>),
		Data:     []<span style="color:#0086b3">byte</span>(_Assetsbfa8d115ce0617d89507412d5393a462f8e9b003),
	}, <span style="color:#d14">&#34;/html/index.tmpl&#34;</span>: {
		Path:     <span style="color:#d14">&#34;/html/index.tmpl&#34;</span>,
		FileMode: <span style="color:#099">0x1a4</span>,
		Mtime:    time.<span style="color:#900;font-weight:bold">Unix</span>(<span style="color:#099">1524365491</span>, <span style="color:#099">1524365491289995821</span>),
		Data:     []<span style="color:#0086b3">byte</span>(_Assets3737a75b5254ed1f6d588b40a3449721f9ea86c2),
	}}, <span style="color:#d14">&#34;&#34;</span>)
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
	<span style="color:#d14">&#34;io/ioutil&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>
	<span style="color:#d14">&#34;strings&#34;</span>
	<span style="color:#d14">&#34;html/template&#34;</span>

)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">New</span>()

	t, err <span style="color:#000;font-weight:bold">:=</span> <span style="color:#900;font-weight:bold">loadTemplate</span>() <span style="color:#998;font-style:italic">//加载go-assets-builder生成的模板
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
		<span style="color:#0086b3">panic</span>(err)
	}
	r.<span style="color:#900;font-weight:bold">SetHTMLTemplate</span>(t)

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">HTML</span>(http.StatusOK, <span style="color:#d14">&#34;/html/index.tmpl&#34;</span>,<span style="color:#000;font-weight:bold">nil</span>)
	})
	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}

<span style="color:#998;font-style:italic">// loadTemplate loads templates embedded by go-assets-builder
</span><span style="color:#998;font-style:italic">// 加载go-assets-builder生成的资产文件, 返回模板的地址
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">loadTemplate</span>() (<span style="color:#000;font-weight:bold">*</span>template.Template, <span style="color:#458;font-weight:bold">error</span>) {
	t <span style="color:#000;font-weight:bold">:=</span> template.<span style="color:#900;font-weight:bold">New</span>(<span style="color:#d14">&#34;&#34;</span>)
	<span style="color:#000;font-weight:bold">for</span> name, file <span style="color:#000;font-weight:bold">:=</span> <span style="color:#000;font-weight:bold">range</span> Assets.Files {
		<span style="color:#000;font-weight:bold">defer</span> file.<span style="color:#900;font-weight:bold">Close</span>()
		<span style="color:#000;font-weight:bold">if</span> file.<span style="color:#900;font-weight:bold">IsDir</span>() <span style="color:#000;font-weight:bold">||</span> !strings.<span style="color:#900;font-weight:bold">HasSuffix</span>(name, <span style="color:#d14">&#34;.tmpl&#34;</span>) {  <span style="color:#998;font-style:italic">//跳过目录或没有.tmpl后缀的文件
</span><span style="color:#998;font-style:italic"></span>			<span style="color:#000;font-weight:bold">continue</span>
		}
		h, err <span style="color:#000;font-weight:bold">:=</span> ioutil.<span style="color:#900;font-weight:bold">ReadAll</span>(file)
		<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
			<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">nil</span>, err
		}
		t, err = t.<span style="color:#900;font-weight:bold">New</span>(name).<span style="color:#900;font-weight:bold">Parse</span>(<span style="color:#0086b3">string</span>(h))  <span style="color:#998;font-style:italic">//新建一个模板, 文件名做为模板名, 文件内容作为模板内容
</span><span style="color:#998;font-style:italic"></span>		<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
			<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">nil</span>, err
		}
	}
	<span style="color:#000;font-weight:bold">return</span> t, <span style="color:#000;font-weight:bold">nil</span>
}
</code></pre></td></tr></table>
</div>
</div><p>完整示例请查看该<a href="https://github.com/gin-gonic/examples/tree/master/assets-in-binary">目录</a></p>
<h3 id="使用自定义的结构绑定请求表单">使用自定义的结构绑定请求表单</h3>
<p>参考实例代码:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">type</span> StructA <span style="color:#000;font-weight:bold">struct</span> {
    FieldA <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;field_a&#34;`</span>
}

<span style="color:#000;font-weight:bold">type</span> StructB <span style="color:#000;font-weight:bold">struct</span> {
    NestedStruct StructA
    FieldB <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;field_b&#34;`</span>
}

<span style="color:#000;font-weight:bold">type</span> StructC <span style="color:#000;font-weight:bold">struct</span> {
    NestedStructPointer <span style="color:#000;font-weight:bold">*</span>StructA
    FieldC <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;field_c&#34;`</span>
}

<span style="color:#000;font-weight:bold">type</span> StructD <span style="color:#000;font-weight:bold">struct</span> {
    NestedAnonyStruct <span style="color:#000;font-weight:bold">struct</span> {
        FieldX <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;field_x&#34;`</span>
    }
    FieldD <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`form:&#34;field_d&#34;`</span>
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">GetDataB</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">var</span> b StructB
    c.<span style="color:#900;font-weight:bold">Bind</span>(<span style="color:#000;font-weight:bold">&amp;</span>b)
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{
        <span style="color:#d14">&#34;a&#34;</span>: b.NestedStruct,
        <span style="color:#d14">&#34;b&#34;</span>: b.FieldB,
    })
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">GetDataC</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">var</span> b StructC
    c.<span style="color:#900;font-weight:bold">Bind</span>(<span style="color:#000;font-weight:bold">&amp;</span>b)
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{
        <span style="color:#d14">&#34;a&#34;</span>: b.NestedStructPointer,
        <span style="color:#d14">&#34;c&#34;</span>: b.FieldC,
    })
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">GetDataD</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
    <span style="color:#000;font-weight:bold">var</span> b StructD
    c.<span style="color:#900;font-weight:bold">Bind</span>(<span style="color:#000;font-weight:bold">&amp;</span>b)
    c.<span style="color:#900;font-weight:bold">JSON</span>(<span style="color:#099">200</span>, gin.H{
        <span style="color:#d14">&#34;x&#34;</span>: b.NestedAnonyStruct,
        <span style="color:#d14">&#34;d&#34;</span>: b.FieldD,
    })
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
    r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
    r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/getb&#34;</span>, GetDataB)
    r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/getc&#34;</span>, GetDataC)
    r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/getd&#34;</span>, GetDataD)

    r.<span style="color:#900;font-weight:bold">Run</span>()
}
</code></pre></td></tr></table>
</div>
</div><p>使用命令 <code>curl</code> 模拟请求测试和结果如下:</p>
<pre><code>$ curl &quot;http://localhost:8080/getb?field_a=hello&amp;field_b=world&quot;
{&quot;a&quot;:{&quot;FieldA&quot;:&quot;hello&quot;},&quot;b&quot;:&quot;world&quot;}
$ curl &quot;http://localhost:8080/getc?field_a=hello&amp;field_c=world&quot;
{&quot;a&quot;:{&quot;FieldA&quot;:&quot;hello&quot;},&quot;c&quot;:&quot;world&quot;}
$ curl &quot;http://localhost:8080/getd?field_x=hello&amp;field_d=world&quot;
{&quot;d&quot;:&quot;world&quot;,&quot;x&quot;:{&quot;FieldX&quot;:&quot;hello&quot;}}
</code></pre><h3 id="尝试将请求体绑定到不同的结构">尝试将请求体绑定到不同的结构</h3>
<p>常规的方法绑定请求体是调用<code>c.Request.Body</code>, 但是它不能多次被调用</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">type</span> formA <span style="color:#000;font-weight:bold">struct</span> {
  Foo <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`json:&#34;foo&#34; xml:&#34;foo&#34; binding:&#34;required&#34;`</span>
}

<span style="color:#000;font-weight:bold">type</span> formB <span style="color:#000;font-weight:bold">struct</span> {
  Bar <span style="color:#458;font-weight:bold">string</span> <span style="color:#d14">`json:&#34;bar&#34; xml:&#34;bar&#34; binding:&#34;required&#34;`</span>
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">SomeHandler</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
  objA <span style="color:#000;font-weight:bold">:=</span> formA{}
  objB <span style="color:#000;font-weight:bold">:=</span> formB{}
  <span style="color:#998;font-style:italic">// This c.ShouldBind consumes c.Request.Body and it cannot be reused.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// 使用c.ShoudBind消费c.Request.Body, 但是它只能调用一次
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">if</span> errA <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBind</span>(<span style="color:#000;font-weight:bold">&amp;</span>objA); errA <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">`the body should be formA`</span>)
  <span style="color:#998;font-style:italic">// Always an error is occurred by this because c.Request.Body is EOF now.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//这里会报错,因为c.Request.Body已经被消费, 会返回文件结束符EOF
</span><span style="color:#998;font-style:italic"></span>  } <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> errB <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBind</span>(<span style="color:#000;font-weight:bold">&amp;</span>objB); errB <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">`the body should be formB`</span>)
  } <span style="color:#000;font-weight:bold">else</span> {
    <span style="color:#000;font-weight:bold">...</span>
  }
}
</code></pre></td></tr></table>
</div>
</div><p>为了解决这个问题, 可以使用<code>c.ShouldBindBodyWith</code>方法.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">SomeHandler</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
  objA <span style="color:#000;font-weight:bold">:=</span> formA{}
  objB <span style="color:#000;font-weight:bold">:=</span> formB{}
  <span style="color:#998;font-style:italic">// This reads c.Request.Body and stores the result into the context.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">// c.ShouldBindBodyWith方法读取c.Request.Body,并且将结果存储到上下文
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">if</span> errA <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindBodyWith</span>(<span style="color:#000;font-weight:bold">&amp;</span>objA, binding.JSON); errA <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">`the body should be formA`</span>)
  <span style="color:#998;font-style:italic">// At this time, it reuses body stored in the context.
</span><span style="color:#998;font-style:italic"></span>  <span style="color:#998;font-style:italic">//再次调用c.ShouldBindBodyWith时, 可以从上下文中复用请求体内容
</span><span style="color:#998;font-style:italic"></span>  } <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> errB <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindBodyWith</span>(<span style="color:#000;font-weight:bold">&amp;</span>objB, binding.JSON); errB <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">`the body should be formB JSON`</span>)
  <span style="color:#998;font-style:italic">// And it can accepts other formats 也可以接受其他类型的绑定,比如XML
</span><span style="color:#998;font-style:italic"></span>  } <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> errB2 <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">ShouldBindBodyWith</span>(<span style="color:#000;font-weight:bold">&amp;</span>objB, binding.XML); errB2 <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">nil</span> {
    c.<span style="color:#900;font-weight:bold">String</span>(http.StatusOK, <span style="color:#d14">`the body should be formB XML`</span>)
  } <span style="color:#000;font-weight:bold">else</span> {
    <span style="color:#000;font-weight:bold">...</span>
  }
}
</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>c.ShouldBindBodyWith</code> 该方法在绑定前, 将请求体存储到gin上下文中, 所以这会对性能有轻微的影响, 所以如果你只打算绑定一次的时候, 不应该使用该方法.</li>
<li>这种方式仅仅支持以下格式: <code>JSON</code>, <code>XML</code>, <code>MsgPack</code>,<code>ProtoBuf</code>. 对于其他格式, <code>Query</code>, <code>Form</code>, <code>FormPost</code>, <code>FormMultipart</code>, 可以重复使用<code>c.ShouldBind()</code>方法, 而不会带来类似的性能影响, 详见(<a href="https://github.com/gin-gonic/gin/pull/1341">#1341</a>)</li>
</ul>
<h3 id="http2服务推送">http2服务推送</h3>
<p>为了解决HTTP/1.X的网络资源利用率不够高, 延迟问题等, HTTP/2 引入了服务器推送机制来解决这些问题.</p>
<p>http.Pusher需要**go1.8+**版本支持. 详见<a href="https://blog.golang.org/h2push">golang博客</a>.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;html/template&#34;</span>
	<span style="color:#d14">&#34;log&#34;</span>

	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)

<span style="color:#998;font-style:italic">//定义html模板
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">var</span> html = template.<span style="color:#900;font-weight:bold">Must</span>(template.<span style="color:#900;font-weight:bold">New</span>(<span style="color:#d14">&#34;https&#34;</span>).<span style="color:#900;font-weight:bold">Parse</span>(<span style="color:#d14">`
</span><span style="color:#d14">&lt;html&gt;
</span><span style="color:#d14">&lt;head&gt;
</span><span style="color:#d14">  &lt;title&gt;Https Test&lt;/title&gt;
</span><span style="color:#d14">  &lt;script src=&#34;/assets/app.js&#34;&gt;&lt;/script&gt;
</span><span style="color:#d14">&lt;/head&gt;
</span><span style="color:#d14">&lt;body&gt;
</span><span style="color:#d14">  &lt;h1 style=&#34;color:red;&#34;&gt;Welcome, Ginner!&lt;/h1&gt;
</span><span style="color:#d14">&lt;/body&gt;
</span><span style="color:#d14">&lt;/html&gt;
</span><span style="color:#d14">`</span>))

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	r.<span style="color:#900;font-weight:bold">Static</span>(<span style="color:#d14">&#34;/assets&#34;</span>, <span style="color:#d14">&#34;./assets&#34;</span>)
	r.<span style="color:#900;font-weight:bold">SetHTMLTemplate</span>(html)

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		<span style="color:#000;font-weight:bold">if</span> pusher <span style="color:#000;font-weight:bold">:=</span> c.Writer.<span style="color:#900;font-weight:bold">Pusher</span>(); pusher <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> { <span style="color:#998;font-style:italic">//获取推送器
</span><span style="color:#998;font-style:italic"></span>			<span style="color:#998;font-style:italic">// use pusher.Push() to do server push
</span><span style="color:#998;font-style:italic"></span>			<span style="color:#998;font-style:italic">// 使用pusher.Push()方法执行服务端推送动作, 尝试推送app.js文件
</span><span style="color:#998;font-style:italic"></span>			<span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">:=</span> pusher.<span style="color:#900;font-weight:bold">Push</span>(<span style="color:#d14">&#34;/assets/app.js&#34;</span>, <span style="color:#000;font-weight:bold">nil</span>); err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
				log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;Failed to push: %v&#34;</span>, err)
			}
		}
		c.<span style="color:#900;font-weight:bold">HTML</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;https&#34;</span>, gin.H{
			<span style="color:#d14">&#34;status&#34;</span>: <span style="color:#d14">&#34;success&#34;</span>,
		})
	})

	<span style="color:#998;font-style:italic">// Listen and Server in https://127.0.0.1:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">RunTLS</span>(<span style="color:#d14">&#34;:8080&#34;</span>, <span style="color:#d14">&#34;./testdata/server.pem&#34;</span>, <span style="color:#d14">&#34;./testdata/server.key&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="定义路由日志格式">定义路由日志格式</h3>
<p>默认路由日志如下:</p>
<pre><code>[GIN-debug] POST   /foo                      --&gt; main.main.func1 (3 handlers)
[GIN-debug] GET    /bar                      --&gt; main.main.func2 (3 handlers)
[GIN-debug] GET    /status                   --&gt; main.main.func3 (3 handlers)
</code></pre><p>如果你想用给定的格式(如:JSON,键值对等)记录路由日志, 你可以使用<code>gin.DebugPrintRouteFunc</code>方法自定义日志格式, 下面的示例, 我们用日志log标准库记录路由器日志, 当然你也可以使用其他适合业务的日志工具.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;log&#34;</span>
	<span style="color:#d14">&#34;net/http&#34;</span>

	<span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	<span style="color:#998;font-style:italic">//使用DebugPrintRouteFunc设置路由日志记录格式, 这里使用标准库log包记录请求方法/请求路径/控制器名/控制器链个数,
</span><span style="color:#998;font-style:italic"></span>	gin.DebugPrintRouteFunc = <span style="color:#000;font-weight:bold">func</span>(httpMethod, absolutePath, handlerName <span style="color:#458;font-weight:bold">string</span>, nuHandlers <span style="color:#458;font-weight:bold">int</span>) {
		log.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;endpoint %v %v %v %v\n&#34;</span>, httpMethod, absolutePath, handlerName, nuHandlers)
	}

	r.<span style="color:#900;font-weight:bold">POST</span>(<span style="color:#d14">&#34;/foo&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, <span style="color:#d14">&#34;foo&#34;</span>)
	})

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/bar&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, <span style="color:#d14">&#34;bar&#34;</span>)
	})

	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/status&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">JSON</span>(http.StatusOK, <span style="color:#d14">&#34;ok&#34;</span>)
	})

	<span style="color:#998;font-style:italic">// Listen and Server in http://0.0.0.0:8080
</span><span style="color:#998;font-style:italic"></span>	r.<span style="color:#900;font-weight:bold">Run</span>()
}
</code></pre></td></tr></table>
</div>
</div><h3 id="设置和读取cookie">设置和读取Cookie</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">import</span> (
    <span style="color:#d14">&#34;fmt&#34;</span>

    <span style="color:#d14">&#34;github.com/gin-gonic/gin&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {

    router <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()

    router.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/cookie&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
				<span style="color:#998;font-style:italic">//读取Cookie
</span><span style="color:#998;font-style:italic"></span>        cookie, err <span style="color:#000;font-weight:bold">:=</span> c.<span style="color:#900;font-weight:bold">Cookie</span>(<span style="color:#d14">&#34;gin_cookie&#34;</span>)

        <span style="color:#000;font-weight:bold">if</span> err <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">nil</span> {
            cookie = <span style="color:#d14">&#34;NotSet&#34;</span>
          	<span style="color:#998;font-style:italic">//设置Cookie
</span><span style="color:#998;font-style:italic"></span>            c.<span style="color:#900;font-weight:bold">SetCookie</span>(<span style="color:#d14">&#34;gin_cookie&#34;</span>, <span style="color:#d14">&#34;test&#34;</span>, <span style="color:#099">3600</span>, <span style="color:#d14">&#34;/&#34;</span>, <span style="color:#d14">&#34;localhost&#34;</span>, <span style="color:#000;font-weight:bold">false</span>, <span style="color:#000;font-weight:bold">true</span>)
        }

        fmt.<span style="color:#900;font-weight:bold">Printf</span>(<span style="color:#d14">&#34;Cookie value: %s \n&#34;</span>, cookie)
    })

    router.<span style="color:#900;font-weight:bold">Run</span>()
}
</code></pre></td></tr></table>
</div>
</div><h2 id="测试">测试</h2>
<p>推荐使用<code>net/http/httptest</code> 包做HTTP测试.</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">setupRouter</span>() <span style="color:#000;font-weight:bold">*</span>gin.Engine {
	r <span style="color:#000;font-weight:bold">:=</span> gin.<span style="color:#900;font-weight:bold">Default</span>()
	r.<span style="color:#900;font-weight:bold">GET</span>(<span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">func</span>(c <span style="color:#000;font-weight:bold">*</span>gin.Context) {
		c.<span style="color:#900;font-weight:bold">String</span>(<span style="color:#099">200</span>, <span style="color:#d14">&#34;pong&#34;</span>)
	})
	<span style="color:#000;font-weight:bold">return</span> r
}

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">main</span>() {
	r <span style="color:#000;font-weight:bold">:=</span> <span style="color:#900;font-weight:bold">setupRouter</span>()
	r.<span style="color:#900;font-weight:bold">Run</span>(<span style="color:#d14">&#34;:8080&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><p>测试代码示例:</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#000;font-weight:bold">package</span> main

<span style="color:#000;font-weight:bold">import</span> (
	<span style="color:#d14">&#34;net/http&#34;</span>
	<span style="color:#d14">&#34;net/http/httptest&#34;</span>
	<span style="color:#d14">&#34;testing&#34;</span>

	<span style="color:#d14">&#34;github.com/stretchr/testify/assert&#34;</span>
)

<span style="color:#000;font-weight:bold">func</span> <span style="color:#900;font-weight:bold">TestPingRoute</span>(t <span style="color:#000;font-weight:bold">*</span>testing.T) {
	router <span style="color:#000;font-weight:bold">:=</span> <span style="color:#900;font-weight:bold">setupRouter</span>()

	w <span style="color:#000;font-weight:bold">:=</span> httptest.<span style="color:#900;font-weight:bold">NewRecorder</span>()
	req, _ <span style="color:#000;font-weight:bold">:=</span> http.<span style="color:#900;font-weight:bold">NewRequest</span>(<span style="color:#d14">&#34;GET&#34;</span>, <span style="color:#d14">&#34;/ping&#34;</span>, <span style="color:#000;font-weight:bold">nil</span>)
	router.<span style="color:#900;font-weight:bold">ServeHTTP</span>(w, req)
  <span style="color:#998;font-style:italic">//断言
</span><span style="color:#998;font-style:italic"></span>	assert.<span style="color:#900;font-weight:bold">Equal</span>(t, <span style="color:#099">200</span>, w.Code)
	assert.<span style="color:#900;font-weight:bold">Equal</span>(t, <span style="color:#d14">&#34;pong&#34;</span>, w.Body.<span style="color:#900;font-weight:bold">String</span>())
}
</code></pre></td></tr></table>
</div>
</div><h2 id="gin框架用户">Gin框架用户</h2>
<p>其他优质的项目也使用<a href="https://github.com/gin-gonic/gin">Gin</a>Web框架.</p>
<ul>
<li><a href="https://github.com/appleboy/gorush">gorush</a>: 一个用GO实现的推送通知系统</li>
<li><a href="https://github.com/fnproject/fn">fnproject</a>: 原生容器化, 无服务的跨云平台</li>
<li><a href="https://github.com/photoprism/photoprism">photoprism</a>: 使用Go和Google的TensorFlow框架支持的个人照片管理</li>
<li><a href="https://github.com/devopsfaith/krakend">krakend</a>: 带有中间件的极致高性能API网关</li>
<li><a href="https://github.com/thoas/picfit">picfit</a>: 使用Go实现的一款图片编辑服务器</li>
<li><a href="https://github.com/brigadecore/brigade">brigade</a>: 为Kubernetes服务的基于事件驱动的脚本</li>
<li><a href="https://github.com/distribworks/dkron">dkron</a>: 分布式, 可靠的任务调度系统</li>
</ul>
<p>​                                                                                 😄都看到这里, 一定是真爱, 关注一个吧!</p>
<p>
        <img class="mx-auto" alt="云原生云二维码" src="img/%e4%ba%91%e5%8e%9f%e7%94%9f%e4%ba%91%e4%ba%8c%e7%bb%b4%e7%a0%81%e5%a4%a7.gif" />   
    </p>

        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://logread.cn">晓兵</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://logread.cn/post/GinWeb%E6%A1%86%E6%9E%B6/">https://logread.cn/post/GinWeb%E6%A1%86%E6%9E%B6/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/fio%E6%96%87%E6%A1%A3-%E8%AF%91/">Fio文档(译)</a></li>
        
        <li><a href="/posts/K8S-%E5%88%A9%E7%94%A8ExecWebsocket%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0Pod%E9%97%B4%E7%9A%84%E6%96%87%E4%BB%B6%E6%8B%B7%E8%B4%9D/">K8S 利用ExecWebsocket接口实现Pod间的文件拷贝</a></li>
        
        <li><a href="/posts/%E4%BB%80%E4%B9%88%E6%98%AFRDB%E5%92%8CROF%E4%B8%80%E6%96%87%E4%BA%86%E8%A7%A3Redis%E6%8C%81%E4%B9%85%E5%8C%96/">什么是RDB和ROF,一文了解Redis持久化</a></li>
        
        <li><a href="/posts/SSD%E6%98%AF%E5%A6%82%E4%BD%95%E5%8F%91%E7%94%9F%E6%95%85%E9%9A%9C%E7%9A%84-NVMeSSD%E7%AE%A1%E7%90%86-%E9%94%99%E8%AF%AF%E6%8A%A5%E5%91%8A%E5%92%8C%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%8A%9F%E8%83%BD/">SSD是如何发生故障的 NVMe™SSD管理 错误报告和日志记录功能</a></li>
        
        <li><a href="/posts/Golang%E7%9A%8423%E7%A7%8D%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%E5%92%8C%E5%9B%BE%E8%A7%A3/">Golang的23种设计模式之代码示例和图解</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/gin'>gin</a></li>
                
                <li><a href='/tags/golang'>golang</a></li>
                
            </ul>
            
        </div>
    </article>
    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "http://github.com/ssbandjl"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                    <footer id="footer">
  <div>
    &copy; 2024
    <a href="https://logread.cn"
      >晓兵(ssbandjl)-技术兴国 By 晓兵</a
    >
    
  </div>
  <br />
  <div>
    <div class="github-badge">
      <a href="https://gohugo.io/" target="_black" rel="nofollow"
        ><span class="badge-subject">Powered by</span
        ><span class="badge-value bg-blue">Hugo</span></a
      >
    </div>
    <div class="github-badge">
      <a href="https://www.logread.cn/" target="_black"
        ><span class="badge-subject">Design by</span
        ><span class="badge-value bg-brightgreen">晓兵</span></a
      >
    </div>
    <div class="github-badge">
      <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"
        ><span class="badge-subject">Theme</span
        ><span class="badge-value bg-yellowgreen">Maupassant</span></a
      >
    </div>
  </div>
</footer>



<script type="text/javascript">
  window.MathJax = {
    tex2jax: {
      inlineMath: [['$', '$']],
      processEscapes: true,
    },
  }
</script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  async
></script>

<a id="rocket" href="#top"></a>
<script
  type="text/javascript"
  src='/js/totop.js?v=0.0.0'
  async=""
></script>
 
<script
  type="text/javascript"
  src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
  async
></script>




<script src='/js/douban.js'></script>


                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://logread.cn/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://logread.cn">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://logread.cn/post/rdma/rdma_odp/" title="RDMA - ODP按需分页设计原理-优点-源码浅析">RDMA - ODP按需分页设计原理-优点-源码浅析</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/nvidia/nvidia_doca/" title="Nvidia DOCA-芯片上的数据中心软硬件架构简介">Nvidia DOCA-芯片上的数据中心软硬件架构简介</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/linux/linux_kernel_driver/" title="Linux内核-驱动技术杂谈">Linux内核-驱动技术杂谈</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/stor/beegfs_storage/" title="Beegfs存储">Beegfs存储</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/nvidia/nvidia_network_tech/" title="Nvidia网络技术-端到端网络解决方案">Nvidia网络技术-端到端网络解决方案</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/nvidia/gpu_direct_rdma/" title="Nvidia 迈络思 OFED GPU直接RDMA">Nvidia 迈络思 OFED GPU直接RDMA</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/rdma/rdma_perf/" title="优化 RDMA 代码的建议和技巧-rdma性能优化技巧-避坑指南">优化 RDMA 代码的建议和技巧-rdma性能优化技巧-避坑指南</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/linux/virtio/" title="VirtIO简介">VirtIO简介</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/net/net_ucx_stor_ucp_uct/" title="统一通信 X(UCX) 实现高性能便携式网络加速-UCX入门教程HOTI2022">统一通信 X(UCX) 实现高性能便携式网络加速-UCX入门教程HOTI2022</a>
    </li>
    
    <li>
        <a href="https://logread.cn/post/daos/daos_mercury_libfabric_rxm_rdma_verbs_rpc_bulk_api/" title="DAOS Mercury(HG) Libfabric(OFI) RDMA 分层verbs接口调用详解">DAOS Mercury(HG) Libfabric(OFI) RDMA 分层verbs接口调用详解</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://logread.cn/categories/Makefile/">Makefile (1)</a></li>
    
    <li><a href="https://logread.cn/categories/aio/">aio (1)</a></li>
    
    <li><a href="https://logread.cn/categories/bcache/">bcache (1)</a></li>
    
    <li><a href="https://logread.cn/categories/daos/">daos (5)</a></li>
    
    <li><a href="https://logread.cn/categories/dpdk/">dpdk (2)</a></li>
    
    <li><a href="https://logread.cn/categories/dpu/">dpu (1)</a></li>
    
    <li><a href="https://logread.cn/categories/golang/">golang (1)</a></li>
    
    <li><a href="https://logread.cn/categories/gpu/">gpu (1)</a></li>
    
    <li><a href="https://logread.cn/categories/hpc/">hpc (1)</a></li>
    
    <li><a href="https://logread.cn/categories/iscsi/">iscsi (1)</a></li>
    
    <li><a href="https://logread.cn/categories/kernel/">kernel (1)</a></li>
    
    <li><a href="https://logread.cn/categories/libfabric/">libfabric (1)</a></li>
    
    <li><a href="https://logread.cn/categories/linux/">linux (1)</a></li>
    
    <li><a href="https://logread.cn/categories/multipath/">multipath (1)</a></li>
    
    <li><a href="https://logread.cn/categories/net/">net (1)</a></li>
    
    <li><a href="https://logread.cn/categories/network/">network (2)</a></li>
    
    <li><a href="https://logread.cn/categories/nvidia/">nvidia (1)</a></li>
    
    <li><a href="https://logread.cn/categories/nvmeof/">nvmeof (1)</a></li>
    
    <li><a href="https://logread.cn/categories/ofa/">ofa (2)</a></li>
    
    <li><a href="https://logread.cn/categories/qemu/">qemu (1)</a></li>
    
    <li><a href="https://logread.cn/categories/rdma/">rdma (9)</a></li>
    
    <li><a href="https://logread.cn/categories/roce/">roce (1)</a></li>
    
    <li><a href="https://logread.cn/categories/rpc/">rpc (1)</a></li>
    
    <li><a href="https://logread.cn/categories/spdk/">spdk (3)</a></li>
    
    <li><a href="https://logread.cn/categories/stor/">stor (31)</a></li>
    
    <li><a href="https://logread.cn/categories/virtio/">virtio (1)</a></li>
    
    <li><a href="https://logread.cn/categories/%E5%AD%98%E5%82%A8/">存储 (36)</a></li>
    
    <li><a href="https://logread.cn/categories/%E5%AD%A6%E4%B9%A0/">学习 (1)</a></li>
    
    <li><a href="https://logread.cn/categories/%E6%A1%86%E6%9E%B6/">框架 (1)</a></li>
    
    <li><a href="https://logread.cn/categories/%E7%BC%93%E5%AD%98/">缓存 (1)</a></li>
    
    <li><a href="https://logread.cn/categories/%E7%BC%96%E8%AF%91/">编译 (1)</a></li>
    
    <li><a href="https://logread.cn/categories/%E7%BD%91%E7%BB%9C/">网络 (6)</a></li>
    
    <li><a href="https://logread.cn/categories/%E9%93%BE%E6%8E%A5/">链接 (1)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
  
  <a href="https://logread.cn/tags/aio/">aio</a>
  
  <a href="https://logread.cn/tags/bcache/">bcache</a>
  
  <a href="https://logread.cn/tags/bdev/">bdev</a>
  
  <a href="https://logread.cn/tags/build/">build</a>
  
  <a href="https://logread.cn/tags/c&#43;&#43;/">c&#43;&#43;</a>
  
  <a href="https://logread.cn/tags/ceph/">ceph</a>
  
  <a href="https://logread.cn/tags/daos/">daos</a>
  
  <a href="https://logread.cn/tags/dpdk/">dpdk</a>
  
  <a href="https://logread.cn/tags/dpu/">dpu</a>
  
  <a href="https://logread.cn/tags/gin/">gin</a>
  
  <a href="https://logread.cn/tags/golang/">golang</a>
  
  <a href="https://logread.cn/tags/gpu/">gpu</a>
  
  <a href="https://logread.cn/tags/hpc/">hpc</a>
  
  <a href="https://logread.cn/tags/iscsi/">iscsi</a>
  
  <a href="https://logread.cn/tags/kernel/">kernel</a>
  
  <a href="https://logread.cn/tags/libfabric/">libfabric</a>
  
  <a href="https://logread.cn/tags/linux/">linux</a>
  
  <a href="https://logread.cn/tags/makefile/">makefile</a>
  
  <a href="https://logread.cn/tags/net/">net</a>
  
  <a href="https://logread.cn/tags/network/">network</a>
  
  <a href="https://logread.cn/tags/nvidia/">nvidia</a>
  
  <a href="https://logread.cn/tags/nvmeof/">nvmeof</a>
  
  <a href="https://logread.cn/tags/ofa/">ofa</a>
  
  <a href="https://logread.cn/tags/optane/">optane</a>
  
  <a href="https://logread.cn/tags/pm/">pm</a>
  
  <a href="https://logread.cn/tags/rdma/">rdma</a>
  
  <a href="https://logread.cn/tags/roce/">roce</a>
  
  <a href="https://logread.cn/tags/rpc/">rpc</a>
  
  <a href="https://logread.cn/tags/spdk/">spdk</a>
  
  <a href="https://logread.cn/tags/stor/">stor</a>
  
  <a href="https://logread.cn/tags/virtio/">virtio</a>
  
  <a href="https://logread.cn/tags/%E5%A4%9A%E8%B7%AF%E5%BE%84/">多路径</a>
  
  <a href="https://logread.cn/tags/%E5%AD%98%E5%82%A8/">存储</a>
  
  <a href="https://logread.cn/tags/%E5%AD%A6%E4%B9%A0/">学习</a>
  
  <a href="https://logread.cn/tags/%E7%BD%91%E7%BB%9C/">网络</a>
  
</div>

    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://cloud.tencent.com/developer/user/5060293/articles" title="晓兵">晓兵</a>
        </li>
        
        <li>
            <a target="_blank" href="https://chattoyou.cn" title="AI吐槽工具">AI吐槽工具(小喇叭)</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://logread.cn/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>